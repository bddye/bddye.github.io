

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon.jpg">
  <link rel="icon" href="/img/icon.jpg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="蹦跶的鱼儿">
  <meta name="keywords" content="RSA,解方程,不互素">
  
    <meta name="description" content="2024浙江省赛是 2024浙江省赛 哒！ 预赛myez_encodesinqwq 1234567891011121314151617181920212223242526272829303132333435363738394041424344from Crypto.Util.number import bytes_to_long, getPrimefrom sympy import isprime">
<meta property="og:type" content="article">
<meta property="og:title" content="2024浙江省赛">
<meta property="og:url" content="https://bddye.github.io/2025/02/01/2024%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B/index.html">
<meta property="og:site_name" content="蹦跶的鱼儿">
<meta property="og:description" content="2024浙江省赛是 2024浙江省赛 哒！ 预赛myez_encodesinqwq 1234567891011121314151617181920212223242526272829303132333435363738394041424344from Crypto.Util.number import bytes_to_long, getPrimefrom sympy import isprime">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://bddye.github.io/2025/02/01/2024%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B/2.png">
<meta property="og:image" content="https://bddye.github.io/2025/02/01/2024%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B/3.png">
<meta property="og:image" content="https://bddye.github.io/2025/02/01/2024%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B/4.png">
<meta property="og:image" content="https://bddye.github.io/2025/02/01/2024%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B/1.jpg">
<meta property="article:published_time" content="2025-01-31T16:44:14.000Z">
<meta property="article:modified_time" content="2025-04-05T10:06:34.621Z">
<meta property="article:author" content="蹦跶的鱼儿">
<meta property="article:tag" content="crypto">
<meta property="article:tag" content="RSA">
<meta property="article:tag" content="DASCTF">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://bddye.github.io/2025/02/01/2024%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B/2.png">
  
  
  
  <title>2024浙江省赛 - 蹦跶的鱼儿</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"bddye.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>蹦跶的鱼儿的池塘</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/background.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="2024浙江省赛"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-02-01 00:44" pubdate>
          2025年2月1日 凌晨
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          7.8k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          65 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">2024浙江省赛</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="2024浙江省赛"><a href="#2024浙江省赛" class="headerlink" title="2024浙江省赛"></a>2024浙江省赛</h1><p>是 <strong>2024浙江省赛</strong> 哒！</p>
<h2 id="预赛"><a href="#预赛" class="headerlink" title="预赛"></a>预赛</h2><h3 id="myez-encode"><a href="#myez-encode" class="headerlink" title="myez_encode"></a>myez_encode</h3><p>sinqwq</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> bytes_to_long, getPrime<br><span class="hljs-keyword">from</span> sympy <span class="hljs-keyword">import</span> isprime<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_ecc_parameters</span>():<br>    x = random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">512</span>)<br>    y = random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">512</span>)<br>    <span class="hljs-keyword">return</span> x, y<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_prime_on_curve</span>(<span class="hljs-params">x, y, a, b, ecc_p</span>):<br>    p = x<br>    q = y<br>    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> (isprime(p) <span class="hljs-keyword">and</span> isprime(q)):<br>        p = random.randint(<span class="hljs-number">2</span>, ecc_p - <span class="hljs-number">1</span>)<br>        q = (p**<span class="hljs-number">3</span> + a * p + b) % ecc_p<br>    <span class="hljs-keyword">return</span> p, q<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_rsa_parameters</span>():<br>    a = getPrime(<span class="hljs-number">512</span>) <br>    b = getPrime(<span class="hljs-number">512</span>)   <br>    ecc_p = getPrime(<span class="hljs-number">512</span>)  <br>    x, y = generate_ecc_parameters()<br>    p, q = find_prime_on_curve(x, y, a, b, ecc_p)<br>    n = p * q<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p= <span class="hljs-subst">&#123;p&#125;</span>\nq= <span class="hljs-subst">&#123;q&#125;</span>\nn= <span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;a= <span class="hljs-subst">&#123;a&#125;</span>\nb= <span class="hljs-subst">&#123;b&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;P= <span class="hljs-subst">&#123;ecc_p&#125;</span>&quot;</span>)<br>    <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    generate_rsa_parameters()<br><br>n = p*q<br>e = <span class="hljs-number">9</span><br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><span class="hljs-built_in">print</span>(c)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n= 23298836191712395990541254600776262066247692725919114528027158820049802443474994576179738462067629079873633948850637889127452791527914591229415148712172587856497614285410824614070907847594399218298016379507879066220104597707859246179921731928508884947347652904142879813069359815823184922170241099916465722623</span><br><span class="hljs-string">a= 7388665644223916915334064243181348811184637180763467245762518813757790945069068654378380490110607063038613823004593920489924786053478102905200169738195523</span><br><span class="hljs-string">b= 11742940161647091720180482697980016011774828087234021441133595442949631197989696508358388255191793888646498553804646435609849154496274569000398776043150743</span><br><span class="hljs-string">P= 11300086101709077144191286182913849072593185125745291892398153828719453495325025227858328617077648296782357912556752467026523366682963139253552060862229027</span><br><span class="hljs-string">c= 9314530945343661153059846131608414257092556390479105017633636336832925597262814680689800448223193301814365726128618348603188219757245073917910487794768758461683644600756896595336654006282030911824869219015400826589122838492456940861634378619000373353637666835642505021355710338342048772713981673863167110471</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>

<p>给出了q &#x3D; (p*<em>3 + a * p + b) % ecc_p，n&#x3D;p</em>q<br>设p&#x3D;x，构建ecc_p上的方程解出p</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sage">n= 23298836191712395990541254600776262066247692725919114528027158820049802443474994576179738462067629079873633948850637889127452791527914591229415148712172587856497614285410824614070907847594399218298016379507879066220104597707859246179921731928508884947347652904142879813069359815823184922170241099916465722623<br>a= 7388665644223916915334064243181348811184637180763467245762518813757790945069068654378380490110607063038613823004593920489924786053478102905200169738195523<br>b= 11742940161647091720180482697980016011774828087234021441133595442949631197989696508358388255191793888646498553804646435609849154496274569000398776043150743<br>P= 11300086101709077144191286182913849072593185125745291892398153828719453495325025227858328617077648296782357912556752467026523366682963139253552060862229027<br><br>R=Zmod(P)[&#x27;x&#x27;]<br>x=R.gen()<br>f=(x**3 + a * x + b)*x-n<br>roots=f.roots()<br>print(roots)<br></code></pre></td></tr></table></figure>
<blockquote>
<p>[(2925490712948356009205547798331037409204468852265154197929696123102317330847028997592576845375767951888373634075473448002921250636926630905567362014595493, 1)]</p>
</blockquote>
<p>因为<code>GCD(e,(p-1))</code>是3，而<code>GCD(e,(q-1))</code>是1，所以转换到mod q上</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>p=<span class="hljs-number">2925490712948356009205547798331037409204468852265154197929696123102317330847028997592576845375767951888373634075473448002921250636926630905567362014595493</span><br>q=<span class="hljs-number">7964077988212602731598828926489143570796450850963162530397620970577507270219530635660167912693046701894468774510746807002256765035407708129322533385075411</span><br>e=<span class="hljs-number">9</span><br>d=<span class="hljs-built_in">pow</span>(e,-<span class="hljs-number">1</span>,q-<span class="hljs-number">1</span>)<br>plain=<span class="hljs-built_in">pow</span>(c,d,q)<br><span class="hljs-built_in">print</span>(long_to_bytes(plain))<br></code></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">DASCTF</span><span class="hljs-template-variable">&#123;Very_easy_3NC0dE_Is_1t&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="叠叠乐"><a href="#叠叠乐" class="headerlink" title="叠叠乐"></a>叠叠乐</h3><p>sinqwq</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>m = bytes_to_long(flag)<br>p = getPrime(<span class="hljs-number">1024</span>)<br>q = getPrime(<span class="hljs-number">1024</span>)<br>n = p * q<br>phi = (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>)<br><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>    <span class="hljs-keyword">try</span>:<br>        K, Q, P = getrandbits(<span class="hljs-number">900</span>), getrandbits(<span class="hljs-number">50</span>), getrandbits(<span class="hljs-number">40</span>)<br>        Y = K * Q + P<br>        e = inverse(Y, phi)<br>        <span class="hljs-keyword">if</span> GCD(Y, phi) == <span class="hljs-number">1</span>:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">except</span> ValueError:<br>        <span class="hljs-keyword">continue</span><br>c = <span class="hljs-built_in">pow</span>(m,e,n)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n = <span class="hljs-subst">&#123;n&#125;</span>\ne = <span class="hljs-subst">&#123;e&#125;</span>\nc = <span class="hljs-subst">&#123;c&#125;</span>\nQP = <span class="hljs-subst">&#123;Q^P&#125;</span>&quot;</span>)<br><br>a = getPrime(<span class="hljs-number">256</span>)<br>b = getPrime(<span class="hljs-number">256</span>)<br>ct = getPrime(<span class="hljs-number">256</span>)<br>kp = K&gt;&gt;<span class="hljs-number">256</span>&lt;&lt;<span class="hljs-number">256</span><br>kt = K - kp<br>hint = (a * kt + b) % ct<br><br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;a = <span class="hljs-subst">&#123;a&#125;</span>\nb = <span class="hljs-subst">&#123;b&#125;</span>\nct = <span class="hljs-subst">&#123;ct&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;hint = <span class="hljs-subst">&#123;hint &gt;&gt; <span class="hljs-number">64</span>&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;kp = <span class="hljs-subst">&#123;kp&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;kt = <span class="hljs-subst">&#123;kt &gt;&gt; <span class="hljs-number">64</span>&#125;</span>&quot;</span> )<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">n = 13303856899011983632960307882319638637287550432779792007603701106983751876258258048795658350090305467837563627318527545231628416053156415975945196818433676370277283141965954341888806103176166238312378096457083879950701541506765361840788206662319436206601457152594339944176515389512519816615898370162128798168782601890642932984764317007450016645945780381938581704042377883323192832778751432894895603847845606533248604610646973688090589505251553075107051564166403193760651488750826245412068423204034796156843765421320342265009955812200476134570302591703762798597205025078181770729074023303604132413763581028940724047053</span><br><span class="hljs-string">e = 2733517162977325316168171866728796033084902904187914379488075721239142722580656245473605622483921568453860073436024032094493176750414721945725534405036772939927287999268479777085171913762833110203454301633868757808443485399661516913959111387656462439998435796234902268408475529868761969365402107153613238260226108864951738479939189489551038436191545122312333617807990694525995038168231022704371131328332275808094810800990404143404473637884482394299488230831809795888381186519555285694029266922792625447331253019632257369630552871013035628858621927646094270019889444050527156845910381295069049755746679380460434044361</span><br><span class="hljs-string">c = 1257188899046514997272405325110424564385768024060742063320284255988190007584654784656431260867071493048511123353948069507669503633550848919744874511579443966819136329852114472266216895363699392703786987813179700514033350248365850450092001546491420343429207567685052543332537686663079614502304203291177287727697712338767938071399864090084866741203851028912823360536739689896262852936314757299216155671690262149783045336778852616143194149940631969143394631299410783137418636516190101007126937403728720725015452113538709754534149425438610714702079839102903881751106774919038549406459141819940733821104205463323546057321</span><br><span class="hljs-string">QP = 374563570713029</span><br><span class="hljs-string">a = 99122984274070362726537021378927027394007193977385990197140215753769750795421</span><br><span class="hljs-string">b = 109980476177887671809918999270373802499713895541798303554775830754300928967413</span><br><span class="hljs-string">ct = 107507754155219159022820175387994991690395542115681890441982942540734100538841</span><br><span class="hljs-string">hint = 4003137201644984429135979790277666488437115932866581847838</span><br><span class="hljs-string">kp = 7184356853939910548131241595220948851978680431483401537207787860047928595973775242115057099194568802207740239839134611884070301385515936096797317313765187937716505251256116706827496362883360670296901928436254026774384214648582578725974699293753323212294005332698430701568</span><br><span class="hljs-string">kt = 2000588514863262877141025511928564790205362046489313378420</span><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<p>题目给出了hint和kp的高192位，要求恢复K，再恢复Y，然后解RSA即可。<br>多元coppersmith梭了。<br>复现的脚本:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs sage">import itertools<br><br>def small_roots(f, bounds, m=1, d=None):<br>    if not d:<br>        d = f.degree()<br> <br>    R = f.base_ring()<br>    N = R.cardinality()<br> <br>    f /= f.coefficients().pop(0)<br>    f = f.change_ring(ZZ)<br> <br>    G = Sequence([], f.parent())<br>    for i in range(m + 1):<br>        base = N ^ (m - i) * f ^ i<br>        for shifts in itertools.product(range(d), repeat=f.nvariables()):<br>            g = base * prod(map(power, f.variables(), shifts))<br>            G.append(g)<br> <br>    B, monomials = G.coefficient_matrix()<br>    monomials = vector(monomials)<br> <br>    factors = [monomial(*bounds) for monomial in monomials]<br>    for i, factor in enumerate(factors):<br>        B.rescale_col(i, factor)<br> <br>    B = B.dense_matrix().LLL()<br> <br>    B = B.change_ring(QQ)<br>    for i, factor in enumerate(factors):<br>        B.rescale_col(i, 1 / factor)<br> <br>    H = Sequence([], f.parent().change_ring(QQ))<br>    for h in filter(None, B * monomials):<br>        H.append(h)<br>        I = H.ideal()<br>        if I.dimension() == -1:<br>            H.pop()<br>        elif I.dimension() == 0:<br>            roots = []<br>            for root in I.variety(ring=ZZ):<br>                root = tuple(R(root[var]) for var in f.variables())<br>                roots.append(root)<br>            return roots<br>    return []<br><br><br>n = <br>e = <br>c = <br>QP = <br>a = <br>b = <br>ct = <br>hint = <br>kp = <br>kt = <br>P.&lt;x,y&gt; = PolynomialRing(Zmod(ct))<br>f=a*((kt&lt;&lt;64)+x)+b-(hint&lt;&lt;64)-y<br>bounds=(2^64,2^64)<br>res = small_roots(f,bounds,m =2 ,d = 2)<br>print(res)<br><br>dkt=res[0][0]<br>dh=res[0][1]<br>kt=(kt&lt;&lt;64)+dkt<br>hint=(hint&lt;&lt;64)+dh<br>assert hint == (a * kt + b) % ct<br>K=int(kp)+int(kt)<br>print(K)<br></code></pre></td></tr></table></figure>
<p>下一个还是多元coppersmith。<br>找的小鸡块的博客:<a target="_blank" rel="noopener" href="https://tangcuxiaojikuai.xyz/post/4311e802.html#Week-4-Danger-Leak">Danger Leak</a><br><img src="/2025/02/01/2024%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B/2.png" srcset="/img/loading.gif" lazyload><br>直接按照这个构建一下方程，解一下即可。第二个参数调错了导致我死活解不出来…<br>脚本:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sage">R.&lt;x,y,z&gt; = PolynomialRing(Zmod(e*K))<br>f=e*x - 1 - n*y + y*z<br>bounds=(2^39, 2^947, 2^1025)<br><br>res = small_roots(f,bounds,m =3 ,d = 3)<br></code></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs result">[(944458204083, 552560007843076923398164260994159471807550408694526455233352292531945811156310842419047890332009181413495561481756007924157620126366568469123253368740622107077476645222325656305794977621972645408084023732255953798516849162998553825344237466120566386612181335521132040599181606274560641, 235681768835910777712622269457346978821121797522206608887974456212118979486411195712467848203727919845155536551605550715865106258897298449186222892938047506561981718836263182343343122200026888924819782172663699192899753711204849338725765643146319190364107913200366351844540910550001346645855729485732602826765)]<br></code></pre></td></tr></table></figure>
<p>最后算一下Y，解个RSA即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sage">from Crypto.Util.number import *<br>P=int(res[0][0])<br>Q=QP^^P<br>Y=K*Q+P<br>plain=int(pow(c,Y,n))<br>print(long_to_bytes(plain))<br>#b&#x27;DASCTF&#123;6a4ba557-4fe7-4874-8dad-40e880cb7717&#125;&#x27;<br></code></pre></td></tr></table></figure>

<h3 id="SNOW"><a href="#SNOW" class="headerlink" title="SNOW"></a>SNOW</h3><p>task.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sourcecode.secret <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">from</span> snow <span class="hljs-keyword">import</span> * <br><span class="hljs-keyword">import</span> random<br><br>key = [random.getrandbits(<span class="hljs-number">32</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]<br>iv = [random.getrandbits(<span class="hljs-number">32</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]<br><br>s = Snow(key,iv)<br><br><br>gift = <span class="hljs-string">b&quot;the quick brown fox jumps over the lazy dog\n&quot;</span><br>plain = gift + flag<br><br>key_stream = s.generate_keystream(<span class="hljs-built_in">len</span>(plain))<br>C = [i^j <span class="hljs-keyword">for</span> i,j <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(plain,key_stream)]<br><span class="hljs-built_in">print</span>(C)<br>s.hack()<br><br><span class="hljs-comment"># [3539094009, 980211684, 2198891016, 905998740, 1595475160, 3962636204, 1199994505, 3190370623, 296595869, 3158272345, 2748985736, 382671580, 2521428409, 248078233, 1528783547, 2729100548, 3426466722, 3192873770, 1337295957, 1431041587, 1607853207, 3998694569, 3160389002, 3728077354, 1120982789, 3443900372, 1811224296, 3102761228, 3296566547, 3724398326, 873334127, 3279785283, 1267844209, 907638672, 2121413959, 3173567371, 4097722407, 844863077, 3114817962, 3619759560, 2198708209, 2363435526, 196774438, 2671749579, 4031688923, 471349633, 778676959, 3608967403, 92491149, 913291948, 3021362116, 1067932129, 999259588, 3190588842, 1828097126, 1450255462, 1305572961, 1341694028, 2350778224, 2932388574, 1204050979, 1294999174, 1921124090, 2342994011, 1941020673, 1191919176, 187588176, 255691701, 274795123, 873091533, 299848364, 870697920, 3387594780, 944072831, 848477078, 447469593, 917439649, 598555627, 3036173079, 3758185777, 4236584984, 4205933999, 1185586113, 3227810954, 2737102694, 3680871868, 4102277292, 378037705]</span><br><span class="hljs-comment"># 834501734,940247165,2078728259,483907438,1102712410,3110955761,3016462560,871310805,1334672645,1102778698</span><br></code></pre></td></tr></table></figure>
<p>snow.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><br><br><span class="hljs-comment"># 定义 S-box</span><br>sr = np.array([<br>    <span class="hljs-number">0x63</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0xf2</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0xc5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x2b</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0xd7</span>, <span class="hljs-number">0xab</span>, <span class="hljs-number">0x76</span>,<br>    <span class="hljs-number">0xca</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0xd4</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x9c</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xc0</span>,<br>    <span class="hljs-number">0xb7</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x15</span>,<br>    <span class="hljs-number">0x04</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x9a</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xb2</span>, <span class="hljs-number">0x75</span>,<br>    <span class="hljs-number">0x09</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0xd6</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x84</span>,<br>    <span class="hljs-number">0x53</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0x5b</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0xcb</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xcf</span>,<br>    <span class="hljs-number">0xd0</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0xa8</span>,<br>    <span class="hljs-number">0x51</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0xbc</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0xd2</span>,<br>    <span class="hljs-number">0xcd</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xec</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0x7e</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x73</span>,<br>    <span class="hljs-number">0x60</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0xdb</span>,<br>    <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3a</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5c</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xe4</span>, <span class="hljs-number">0x79</span>,<br>    <span class="hljs-number">0xe7</span>, <span class="hljs-number">0xc8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xf4</span>, <span class="hljs-number">0xea</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x08</span>,<br>    <span class="hljs-number">0xba</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0xb4</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x8a</span>,<br>    <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xb9</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x9e</span>,<br>    <span class="hljs-number">0xe1</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xdf</span>,<br>    <span class="hljs-number">0x8c</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0xb0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0x16</span><br>], dtype=np.uint8)<br><br>sq = np.array([<br>    <span class="hljs-number">0x25</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xd7</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x5c</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0xcb</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xdb</span>,<br>    <span class="hljs-number">0xe4</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xe2</span>,<br>    <span class="hljs-number">0xd8</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xd2</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0xb9</span>,<br>    <span class="hljs-number">0xb2</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xd4</span>,<br>    <span class="hljs-number">0xca</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x64</span>,<br>    <span class="hljs-number">0x83</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xb4</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xcd</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xf4</span>,<br>    <span class="hljs-number">0x8d</span>, <span class="hljs-number">0xb0</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xfa</span>,<br>    <span class="hljs-number">0xbc</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0xc5</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x5b</span>, <span class="hljs-number">0x5a</span>,<br>    <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x9a</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0x7e</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x8a</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0xdc</span>,<br>    <span class="hljs-number">0x03</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0xf2</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x00</span>,<br>    <span class="hljs-number">0x06</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0xea</span>, <span class="hljs-number">0xb7</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xd6</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x53</span>,<br>    <span class="hljs-number">0x63</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0xbd</span>,<br>    <span class="hljs-number">0xd9</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xc8</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x9c</span>,<br>    <span class="hljs-number">0xdf</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xab</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x2b</span>,<br>    <span class="hljs-number">0xad</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xec</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x3a</span>,<br>    <span class="hljs-number">0x56</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xa8</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0x86</span><br>], dtype=np.uint8)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Snow</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, k, iv</span>):<br>        <span class="hljs-variable language_">self</span>.lfsr = np.zeros(<span class="hljs-number">16</span>, dtype=np.uint32)<br>        <span class="hljs-variable language_">self</span>.fsm = np.zeros(<span class="hljs-number">3</span>, dtype=np.uint32)<br>        <span class="hljs-variable language_">self</span>.initialize(k, iv)<br>        <span class="hljs-variable language_">self</span>.S =[]<br>        <span class="hljs-variable language_">self</span>.R1 = []<br>        <span class="hljs-variable language_">self</span>.R2 = []<br>        <span class="hljs-variable language_">self</span>.R3 = []<br>        <br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mulx</span>(<span class="hljs-params">self, V, c</span>):<br>        <span class="hljs-keyword">if</span> V &amp; <span class="hljs-number">0x80</span>:<br>            <span class="hljs-keyword">return</span> (V &lt;&lt; <span class="hljs-number">1</span>) ^ c<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> V &lt;&lt; <span class="hljs-number">1</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mulx_pow</span>(<span class="hljs-params">self, V, i, c</span>):<br>        <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> V<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.mulx(<span class="hljs-variable language_">self</span>.mulx_pow(V, i - <span class="hljs-number">1</span>, c), c)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">s1</span>(<span class="hljs-params">self, w</span>):<br>        w0 = (w &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span><br>        w1 = (w &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span><br>        w2 = (w &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span><br>        w3 = w &amp; <span class="hljs-number">0xff</span><br><br>        r0 = (<span class="hljs-variable language_">self</span>.mulx(sr[w0], <span class="hljs-number">0x1b</span>) ^ sr[w1] ^ sr[w2] ^ <span class="hljs-variable language_">self</span>.mulx(sr[w3], <span class="hljs-number">0x1b</span>) ^ sr[w3]) &amp; <span class="hljs-number">0xff</span><br>        r1 = (<span class="hljs-variable language_">self</span>.mulx(sr[w0], <span class="hljs-number">0x1b</span>) ^ sr[w0] ^ <span class="hljs-variable language_">self</span>.mulx(sr[w1], <span class="hljs-number">0x1b</span>) ^ sr[w2] ^ sr[w3]) &amp; <span class="hljs-number">0xff</span><br>        r2 = (sr[w0] ^ <span class="hljs-variable language_">self</span>.mulx(sr[w1], <span class="hljs-number">0x1b</span>) ^ sr[w1] ^ <span class="hljs-variable language_">self</span>.mulx(sr[w2], <span class="hljs-number">0x1b</span>) ^ sr[w3]) &amp; <span class="hljs-number">0xff</span><br>        r3 = (sr[w0] ^ sr[w1] ^ <span class="hljs-variable language_">self</span>.mulx(sr[w2], <span class="hljs-number">0x1b</span>) ^ sr[w2] ^ <span class="hljs-variable language_">self</span>.mulx(sr[w3], <span class="hljs-number">0x1b</span>)) &amp; <span class="hljs-number">0xff</span><br><br>        <span class="hljs-keyword">return</span> (r0 &lt;&lt; <span class="hljs-number">24</span>) | (r1 &lt;&lt; <span class="hljs-number">16</span>) | (r2 &lt;&lt; <span class="hljs-number">8</span>) | r3<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">s2</span>(<span class="hljs-params">self, w</span>):<br>        w0 = (w &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span><br>        w1 = (w &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span><br>        w2 = (w &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span><br>        w3 = w &amp; <span class="hljs-number">0xff</span><br><br>        r0 = (<span class="hljs-variable language_">self</span>.mulx(sq[w0], <span class="hljs-number">0x69</span>) ^ sq[w1] ^ sq[w2] ^ <span class="hljs-variable language_">self</span>.mulx(sq[w3], <span class="hljs-number">0x69</span>) ^ sq[w3]) &amp; <span class="hljs-number">0xff</span><br>        r1 = (<span class="hljs-variable language_">self</span>.mulx(sq[w0], <span class="hljs-number">0x69</span>) ^ sq[w0] ^ <span class="hljs-variable language_">self</span>.mulx(sq[w1], <span class="hljs-number">0x69</span>) ^ sq[w2] ^ sq[w3]) &amp; <span class="hljs-number">0xff</span><br>        r2 = (sq[w0] ^ <span class="hljs-variable language_">self</span>.mulx(sq[w1], <span class="hljs-number">0x69</span>) ^ sq[w1] ^ <span class="hljs-variable language_">self</span>.mulx(sq[w2], <span class="hljs-number">0x69</span>) ^ sq[w3]) &amp; <span class="hljs-number">0xff</span><br>        r3 = (sq[w0] ^ sq[w1] ^ <span class="hljs-variable language_">self</span>.mulx(sq[w2], <span class="hljs-number">0x69</span>) ^ sq[w2] ^ <span class="hljs-variable language_">self</span>.mulx(sq[w3], <span class="hljs-number">0x69</span>)) &amp; <span class="hljs-number">0xff</span><br>        <span class="hljs-keyword">return</span> (r0 &lt;&lt; <span class="hljs-number">24</span>) | (r1 &lt;&lt; <span class="hljs-number">16</span>) | (r2 &lt;&lt; <span class="hljs-number">8</span>) | r3<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mul_alpha</span>(<span class="hljs-params">self, c</span>):<br>        r0 = <span class="hljs-variable language_">self</span>.mulx_pow(c, <span class="hljs-number">23</span>, <span class="hljs-number">0xa9</span>) &amp; <span class="hljs-number">0xff</span><br>        r1 = <span class="hljs-variable language_">self</span>.mulx_pow(c, <span class="hljs-number">245</span>, <span class="hljs-number">0xa9</span>) &amp; <span class="hljs-number">0xff</span><br>        r2 = <span class="hljs-variable language_">self</span>.mulx_pow(c, <span class="hljs-number">48</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>        r3 = <span class="hljs-variable language_">self</span>.mulx_pow(c, <span class="hljs-number">239</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>        <span class="hljs-keyword">return</span> (r0 &lt;&lt; <span class="hljs-number">24</span>) | (r1 &lt;&lt; <span class="hljs-number">16</span>) | (r2 &lt;&lt; <span class="hljs-number">8</span>) | r3<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">div_alpha</span>(<span class="hljs-params">self, c</span>):<br>        r0 = <span class="hljs-variable language_">self</span>.mulx_pow(c, <span class="hljs-number">16</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>        r1 = <span class="hljs-variable language_">self</span>.mulx_pow(c, <span class="hljs-number">39</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>        r2 = <span class="hljs-variable language_">self</span>.mulx_pow(c, <span class="hljs-number">6</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>        r3 = <span class="hljs-variable language_">self</span>.mulx_pow(c, <span class="hljs-number">64</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>        <span class="hljs-keyword">return</span> (r0 &lt;&lt; <span class="hljs-number">24</span>) | (r1 &lt;&lt; <span class="hljs-number">16</span>) | (r2 &lt;&lt; <span class="hljs-number">8</span>) | r3<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr_initialization_mode</span>(<span class="hljs-params">self, F</span>):<br>        v = (<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">8</span>) ^ <span class="hljs-variable language_">self</span>.mul_alpha((<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span>) ^ <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">2</span>] ^ (<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">11</span>] &gt;&gt; <span class="hljs-number">8</span>) ^ \<br>            <span class="hljs-variable language_">self</span>.div_alpha(<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">11</span>] &amp; <span class="hljs-number">0xff</span>) ^ F<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>):<br>            <span class="hljs-variable language_">self</span>.lfsr[i] = <span class="hljs-variable language_">self</span>.lfsr[i + <span class="hljs-number">1</span>]<br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">15</span>] = v<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr_keystream_mode</span>(<span class="hljs-params">self</span>):<br>        v = (<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">8</span>) ^ <span class="hljs-variable language_">self</span>.mul_alpha((<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span>) ^ <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">2</span>] ^ (<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">11</span>] &gt;&gt; <span class="hljs-number">8</span>) ^ \<br>            <span class="hljs-variable language_">self</span>.div_alpha(<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">11</span>] &amp; <span class="hljs-number">0xff</span>)<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>):<br>            <span class="hljs-variable language_">self</span>.lfsr[i] = <span class="hljs-variable language_">self</span>.lfsr[i + <span class="hljs-number">1</span>]<br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">15</span>] = v<br><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">clock_fsm</span>(<span class="hljs-params">self, s15, s5</span>):<br>        F = (s15 + <span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">0</span>]) ^ <span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">1</span>]<br>        r = <span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">1</span>] + (<span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">2</span>] ^ s5)<br>        <span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">2</span>] = <span class="hljs-variable language_">self</span>.s2(<span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">1</span>])<br>        <span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">1</span>] = <span class="hljs-variable language_">self</span>.s1(<span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">0</span>])<br>        <span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">0</span>] = r<br>        <span class="hljs-keyword">return</span> F<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">initialize</span>(<span class="hljs-params">self, k, iv</span>):<br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">0</span>] = k[<span class="hljs-number">0</span>] ^ <span class="hljs-number">0xffffffff</span><br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">1</span>] = k[<span class="hljs-number">1</span>] ^ <span class="hljs-number">0xffffffff</span><br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">2</span>] = k[<span class="hljs-number">2</span>] ^ <span class="hljs-number">0xffffffff</span><br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">3</span>] = k[<span class="hljs-number">3</span>] ^ <span class="hljs-number">0xffffffff</span><br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">4</span>] = k[<span class="hljs-number">0</span>]<br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">5</span>] = k[<span class="hljs-number">1</span>]<br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">6</span>] = k[<span class="hljs-number">2</span>]<br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">7</span>] = k[<span class="hljs-number">3</span>]<br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">8</span>] = k[<span class="hljs-number">0</span>] ^ <span class="hljs-number">0xffffffff</span><br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">9</span>] = k[<span class="hljs-number">1</span>] ^ <span class="hljs-number">0xffffffff</span> ^ iv[<span class="hljs-number">3</span>]<br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">10</span>] = k[<span class="hljs-number">2</span>] ^ <span class="hljs-number">0xffffffff</span> ^ iv[<span class="hljs-number">2</span>]<br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">11</span>] = k[<span class="hljs-number">3</span>] ^ <span class="hljs-number">0xffffffff</span><br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">12</span>] = k[<span class="hljs-number">0</span>] ^ iv[<span class="hljs-number">1</span>]<br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">13</span>] = k[<span class="hljs-number">1</span>]<br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">14</span>] = k[<span class="hljs-number">2</span>]<br>        <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">15</span>] = k[<span class="hljs-number">3</span>] ^ iv[<span class="hljs-number">0</span>]<br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>            <span class="hljs-variable language_">self</span>.fsm[i] = <span class="hljs-number">0</span><br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>            F = <span class="hljs-variable language_">self</span>.clock_fsm(<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">15</span>], <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">5</span>])<br>            <span class="hljs-variable language_">self</span>.lfsr_initialization_mode(F)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">generate_keystream</span>(<span class="hljs-params">self, n</span>):<br>        keystream = np.zeros(n, dtype=np.uint32)<br>        <span class="hljs-variable language_">self</span>.clock_fsm(<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">15</span>], <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">5</span>])<br>        <span class="hljs-variable language_">self</span>.lfsr_keystream_mode()<br>        <span class="hljs-variable language_">self</span>.R1.append(<span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">0</span>])<br>        <span class="hljs-variable language_">self</span>.R2.append(<span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">1</span>])<br>        <span class="hljs-variable language_">self</span>.R3.append(<span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">2</span>])<br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(n):<br>            F = <span class="hljs-variable language_">self</span>.clock_fsm(<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">15</span>], <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">5</span>])<br>            <span class="hljs-variable language_">self</span>.R1.append(<span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">0</span>])<br>            <span class="hljs-variable language_">self</span>.R2.append(<span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">1</span>])<br>            <span class="hljs-variable language_">self</span>.R3.append(<span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">2</span>])<br>            <span class="hljs-variable language_">self</span>.S.append(<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">0</span>])<br>            keystream[i] = F ^ <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">0</span>]<br>            <span class="hljs-variable language_">self</span>.lfsr_keystream_mode()<br>        <span class="hljs-keyword">return</span> keystream<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">hack</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-variable language_">self</span>.R1[<span class="hljs-number">2</span>],<span class="hljs-variable language_">self</span>.R2[<span class="hljs-number">2</span>],<span class="hljs-variable language_">self</span>.R3[<span class="hljs-number">2</span>],<span class="hljs-variable language_">self</span>.S[<span class="hljs-number">2</span>],<span class="hljs-variable language_">self</span>.S[<span class="hljs-number">3</span>],<span class="hljs-variable language_">self</span>.S[<span class="hljs-number">6</span>],<span class="hljs-variable language_">self</span>.S[<span class="hljs-number">7</span>],<span class="hljs-variable language_">self</span>.S[<span class="hljs-number">8</span>],<span class="hljs-variable language_">self</span>.R1[<span class="hljs-number">5</span>],<span class="hljs-variable language_">self</span>.R1[<span class="hljs-number">7</span>],sep=<span class="hljs-string">&quot;,&quot;</span>)<br></code></pre></td></tr></table></figure>
<p>我自己在本地跑的时候是需要稍微改一下源码的，不然数据有问题。<br>得把s1和s2改一下，因为sr和sq是int8的，在return的时候会把那个值也转成int8的，只会得到低8位的值，但题目给出的数据明显不是这样的，所以加点int就好了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">s1</span>(<span class="hljs-params">self, w</span>):<br>        w0 = (w &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span><br>        w1 = (w &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span><br>        w2 = (w &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span><br>        w3 = w &amp; <span class="hljs-number">0xff</span><br><br>        r0 = (<span class="hljs-variable language_">self</span>.mulx(sr[w0], <span class="hljs-number">0x1b</span>) ^ sr[w1] ^ sr[w2] ^ <span class="hljs-variable language_">self</span>.mulx(sr[w3], <span class="hljs-number">0x1b</span>) ^ sr[w3]) &amp; <span class="hljs-number">0xff</span><br>        r1 = (<span class="hljs-variable language_">self</span>.mulx(sr[w0], <span class="hljs-number">0x1b</span>) ^ sr[w0] ^ <span class="hljs-variable language_">self</span>.mulx(sr[w1], <span class="hljs-number">0x1b</span>) ^ sr[w2] ^ sr[w3]) &amp; <span class="hljs-number">0xff</span><br>        r2 = (sr[w0] ^ <span class="hljs-variable language_">self</span>.mulx(sr[w1], <span class="hljs-number">0x1b</span>) ^ sr[w1] ^ <span class="hljs-variable language_">self</span>.mulx(sr[w2], <span class="hljs-number">0x1b</span>) ^ sr[w3]) &amp; <span class="hljs-number">0xff</span><br>        r3 = (sr[w0] ^ sr[w1] ^ <span class="hljs-variable language_">self</span>.mulx(sr[w2], <span class="hljs-number">0x1b</span>) ^ sr[w2] ^ <span class="hljs-variable language_">self</span>.mulx(sr[w3], <span class="hljs-number">0x1b</span>)) &amp; <span class="hljs-number">0xff</span><br><br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(r0) &lt;&lt; <span class="hljs-number">24</span>) | (<span class="hljs-built_in">int</span>(r1) &lt;&lt; <span class="hljs-number">16</span>) | (<span class="hljs-built_in">int</span>(r2) &lt;&lt; <span class="hljs-number">8</span>) | r3<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">s2</span>(<span class="hljs-params">self, w</span>):<br>        w0 = (w &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span><br>        w1 = (w &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span><br>        w2 = (w &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span><br>        w3 = w &amp; <span class="hljs-number">0xff</span><br><br>        r0 = (<span class="hljs-variable language_">self</span>.mulx(sq[w0], <span class="hljs-number">0x69</span>) ^ sq[w1] ^ sq[w2] ^ <span class="hljs-variable language_">self</span>.mulx(sq[w3], <span class="hljs-number">0x69</span>) ^ sq[w3]) &amp; <span class="hljs-number">0xff</span><br>        r1 = (<span class="hljs-variable language_">self</span>.mulx(sq[w0], <span class="hljs-number">0x69</span>) ^ sq[w0] ^ <span class="hljs-variable language_">self</span>.mulx(sq[w1], <span class="hljs-number">0x69</span>) ^ sq[w2] ^ sq[w3]) &amp; <span class="hljs-number">0xff</span><br>        r2 = (sq[w0] ^ <span class="hljs-variable language_">self</span>.mulx(sq[w1], <span class="hljs-number">0x69</span>) ^ sq[w1] ^ <span class="hljs-variable language_">self</span>.mulx(sq[w2], <span class="hljs-number">0x69</span>) ^ sq[w3]) &amp; <span class="hljs-number">0xff</span><br>        r3 = (sq[w0] ^ sq[w1] ^ <span class="hljs-variable language_">self</span>.mulx(sq[w2], <span class="hljs-number">0x69</span>) ^ sq[w2] ^ <span class="hljs-variable language_">self</span>.mulx(sq[w3], <span class="hljs-number">0x69</span>)) &amp; <span class="hljs-number">0xff</span><br>        <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(r0) &lt;&lt; <span class="hljs-number">24</span>) | (<span class="hljs-built_in">int</span>(r1) &lt;&lt; <span class="hljs-number">16</span>) | (<span class="hljs-built_in">int</span>(r2) &lt;&lt; <span class="hljs-number">8</span>) | r3<br></code></pre></td></tr></table></figure>
<p>先说一下大致的思路，这题我们要拿到flag就要拿到key_stream，而key_stream是由F和lfsr推出来的，F又是由fsm和lfsr推出来的，也就是说我们需要还原fsm和lfsr。所以我们需要去关注一下这两个的推导公式。<br>lfsr:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr_keystream_mode</span>(<span class="hljs-params">self</span>):<br>    v = (<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-number">8</span>) ^ <span class="hljs-variable language_">self</span>.mul_alpha((<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">0</span>] &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span>) ^ <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">2</span>] ^ (<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">11</span>] &gt;&gt; <span class="hljs-number">8</span>) ^ \<br>        <span class="hljs-variable language_">self</span>.div_alpha(<span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">11</span>] &amp; <span class="hljs-number">0xff</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">15</span>):<br>        <span class="hljs-variable language_">self</span>.lfsr[i] = <span class="hljs-variable language_">self</span>.lfsr[i + <span class="hljs-number">1</span>]<br>    <span class="hljs-variable language_">self</span>.lfsr[<span class="hljs-number">15</span>] = v<br></code></pre></td></tr></table></figure>
<p>这是一个长15的lfsr，也就是说还原出任意连续15个值，我们就能还原出整个lfsr序列。<br>fsm:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">clock_fsm</span>(<span class="hljs-params">self, s15, s5</span>):<br>        F = (s15 + <span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">0</span>]) ^ <span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">1</span>]<br>        r = <span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">1</span>] + (<span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">2</span>] ^ s5)<br>        <span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">2</span>] = <span class="hljs-variable language_">self</span>.s2(<span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">1</span>])<br>        <span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">1</span>] = <span class="hljs-variable language_">self</span>.s1(<span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">0</span>])<br>        <span class="hljs-variable language_">self</span>.fsm[<span class="hljs-number">0</span>] = r<br>        <span class="hljs-keyword">return</span> F<br></code></pre></td></tr></table></figure>
<p>下一轮的fsm由上一轮的fsm和lfsr共同决定。<br>综上，我们只需要获得连续15个lfsr和这15个对应的最开始的fsm就能还原后面的所有数据。<br>这是我复现时手动还原的思路，实际上只需要不断地检查能否推出新的值就可以了。<del>不用管这些有的没的</del><br>首先正向推下一个数据就不用多说了，源码里都有，直接给你们贴出来了:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">mulx</span>(<span class="hljs-params">V, c</span>):<br>    <span class="hljs-keyword">if</span> V &amp; <span class="hljs-number">0x80</span>:<br>        <span class="hljs-keyword">return</span> (V &lt;&lt; <span class="hljs-number">1</span>) ^ c<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> V &lt;&lt; <span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mulx_pow</span>(<span class="hljs-params">V, i, c</span>):<br>    <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> V<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> mulx(mulx_pow(V, i - <span class="hljs-number">1</span>, c), c)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul_alpha</span>(<span class="hljs-params">c</span>):<br>    r0 = mulx_pow(c, <span class="hljs-number">23</span>, <span class="hljs-number">0xa9</span>) &amp; <span class="hljs-number">0xff</span><br>    r1 = mulx_pow(c, <span class="hljs-number">245</span>, <span class="hljs-number">0xa9</span>) &amp; <span class="hljs-number">0xff</span><br>    r2 = mulx_pow(c, <span class="hljs-number">48</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>    r3 = mulx_pow(c, <span class="hljs-number">239</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">return</span> (r0 &lt;&lt; <span class="hljs-number">24</span>) | (r1 &lt;&lt; <span class="hljs-number">16</span>) | (r2 &lt;&lt; <span class="hljs-number">8</span>) | r3<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">div_alpha</span>(<span class="hljs-params">c</span>):<br>    r0 = mulx_pow(c, <span class="hljs-number">16</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>    r1 = mulx_pow(c, <span class="hljs-number">39</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>    r2 = mulx_pow(c, <span class="hljs-number">6</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>    r3 = mulx_pow(c, <span class="hljs-number">64</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">return</span> (r0 &lt;&lt; <span class="hljs-number">24</span>) | (r1 &lt;&lt; <span class="hljs-number">16</span>) | (r2 &lt;&lt; <span class="hljs-number">8</span>) | r3<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s1</span>(<span class="hljs-params">w</span>):<br>    w0 = (w &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span><br>    w1 = (w &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span><br>    w2 = (w &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span><br>    w3 = w &amp; <span class="hljs-number">0xff</span><br><br>    r0 = (mulx(sr[w0], <span class="hljs-number">0x1b</span>) ^ sr[w1] ^ sr[w2] ^ mulx(sr[w3], <span class="hljs-number">0x1b</span>) ^ sr[w3]) &amp; <span class="hljs-number">0xff</span><br>    r1 = (mulx(sr[w0], <span class="hljs-number">0x1b</span>) ^ sr[w0] ^ mulx(sr[w1], <span class="hljs-number">0x1b</span>) ^ sr[w2] ^ sr[w3]) &amp; <span class="hljs-number">0xff</span><br>    r2 = (sr[w0] ^ mulx(sr[w1], <span class="hljs-number">0x1b</span>) ^ sr[w1] ^ mulx(sr[w2], <span class="hljs-number">0x1b</span>) ^ sr[w3]) &amp; <span class="hljs-number">0xff</span><br>    r3 = (sr[w0] ^ sr[w1] ^ mulx(sr[w2], <span class="hljs-number">0x1b</span>) ^ sr[w2] ^ mulx(sr[w3], <span class="hljs-number">0x1b</span>)) &amp; <span class="hljs-number">0xff</span><br><br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(r0) &lt;&lt; <span class="hljs-number">24</span>) | (<span class="hljs-built_in">int</span>(r1) &lt;&lt; <span class="hljs-number">16</span>) | (<span class="hljs-built_in">int</span>(r2) &lt;&lt; <span class="hljs-number">8</span>) | <span class="hljs-built_in">int</span>(r3)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s2</span>(<span class="hljs-params">w</span>):<br>    w0 = (w &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span><br>    w1 = (w &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span><br>    w2 = (w &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span><br>    w3 = w &amp; <span class="hljs-number">0xff</span><br><br>    r0 = (mulx(sq[w0], <span class="hljs-number">0x69</span>) ^ sq[w1] ^ sq[w2] ^ mulx(sq[w3], <span class="hljs-number">0x69</span>) ^ sq[w3]) &amp; <span class="hljs-number">0xff</span><br>    r1 = (mulx(sq[w0], <span class="hljs-number">0x69</span>) ^ sq[w0] ^ mulx(sq[w1], <span class="hljs-number">0x69</span>) ^ sq[w2] ^ sq[w3]) &amp; <span class="hljs-number">0xff</span><br>    r2 = (sq[w0] ^ mulx(sq[w1], <span class="hljs-number">0x69</span>) ^ sq[w1] ^ mulx(sq[w2], <span class="hljs-number">0x69</span>) ^ sq[w3]) &amp; <span class="hljs-number">0xff</span><br>    r3 = (sq[w0] ^ sq[w1] ^ mulx(sq[w2], <span class="hljs-number">0x69</span>) ^ sq[w2] ^ mulx(sq[w3], <span class="hljs-number">0x69</span>)) &amp; <span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(r0) &lt;&lt; <span class="hljs-number">24</span>) | (<span class="hljs-built_in">int</span>(r1) &lt;&lt; <span class="hljs-number">16</span>) | (<span class="hljs-built_in">int</span>(r2) &lt;&lt; <span class="hljs-number">8</span>) | <span class="hljs-built_in">int</span>(r3)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">clock_fsm</span>(<span class="hljs-params">s15, s5</span>):<br>    F = (s15 + fsm[<span class="hljs-number">0</span>]) ^ fsm[<span class="hljs-number">1</span>]<br>    r = fsm[<span class="hljs-number">1</span>] + (fsm[<span class="hljs-number">2</span>] ^ s5)<br>    fsm[<span class="hljs-number">2</span>] = s2(fsm[<span class="hljs-number">1</span>])<br>    fsm[<span class="hljs-number">1</span>] = s1(fsm[<span class="hljs-number">0</span>])<br>    fsm[<span class="hljs-number">0</span>] = r<br>    <span class="hljs-keyword">return</span> F<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr_keystream_mode</span>(<span class="hljs-params">S0,S2,S11</span>):<br>    v = (S0 &lt;&lt; <span class="hljs-number">8</span>) ^ mul_alpha((S0 &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span>) ^ S2 ^ (S11 &gt;&gt; <span class="hljs-number">8</span>) ^ \<br>        div_alpha(S11 &amp; <span class="hljs-number">0xff</span>)<br>    <span class="hljs-keyword">return</span> v<br></code></pre></td></tr></table></figure>
<p>之后我们就需要来通过下一个值来反推上一个值了。我是用的z3来解的。<br>对于s1，s2，函数内部是有对sr，sq的切片的，并且sr，sq里面每一个值都是唯一的，所以我们直接把这4个切片的值设为未知数，解出来后直接在sr，sq里找对应的索引即可。<br>同时我们需要重新定义一下mulx(AI是说是算术右移和逻辑右移的原因，实际解是需要重新定义的)，直接就在函数里面临时定义了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">de_s1</span>(<span class="hljs-params">s</span>):<br>    r0=(s&gt;&gt;<span class="hljs-number">24</span>)&amp;<span class="hljs-number">0xff</span><br>    r1=(s&gt;&gt;<span class="hljs-number">16</span>)&amp;<span class="hljs-number">0xff</span><br>    r2=(s&gt;&gt;<span class="hljs-number">8</span>)&amp;<span class="hljs-number">0xff</span><br>    r3=s&amp;<span class="hljs-number">0xff</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mulx</span>(<span class="hljs-params">V, c</span>):<br>        <span class="hljs-keyword">return</span> (V &lt;&lt; <span class="hljs-number">1</span>) ^ (c*LShR(V, <span class="hljs-number">7</span>))&amp; <span class="hljs-number">0xff</span><br>    solver=Solver()<br>    srw0,srw1,srw2,srw3=BitVecs(<span class="hljs-string">&#x27;srw0 srw1 srw2 srw3&#x27;</span>, <span class="hljs-number">8</span>)<br>    solver.add(r0 == (mulx(srw0, <span class="hljs-number">0x1b</span>) ^ srw1 ^ srw2 ^mulx(srw3, <span class="hljs-number">0x1b</span>) ^ srw3) &amp; <span class="hljs-number">0xff</span>)<br>    solver.add(r1 == (mulx(srw0, <span class="hljs-number">0x1b</span>) ^ srw0 ^ mulx(srw1, <span class="hljs-number">0x1b</span>) ^ srw2 ^ srw3) &amp; <span class="hljs-number">0xff</span>)<br>    solver.add(r2 == (srw0 ^ mulx(srw1, <span class="hljs-number">0x1b</span>) ^ srw1 ^ mulx(srw2, <span class="hljs-number">0x1b</span>) ^ srw3) &amp; <span class="hljs-number">0xff</span>)<br>    solver.add(r3 == (srw0 ^ srw1 ^ mulx(srw2, <span class="hljs-number">0x1b</span>) ^ srw2 ^ mulx(srw3, <span class="hljs-number">0x1b</span>)) &amp; <span class="hljs-number">0xff</span>)<br><br>    <span class="hljs-keyword">if</span> solver.check()==sat:<br>        res=solver.model()<br>        __sr=sr.tolist()<br>        w0=__sr.index(res[srw0].py_value())<br>        w1=__sr.index(res[srw1].py_value())<br>        w2=__sr.index(res[srw2].py_value())<br>        w3=__sr.index(res[srw3].py_value())<br>        <span class="hljs-keyword">return</span> (w0 &lt;&lt; <span class="hljs-number">24</span>) | (w1 &lt;&lt; <span class="hljs-number">16</span>) | (w2 &lt;&lt; <span class="hljs-number">8</span>) | w3<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">de_s2</span>(<span class="hljs-params">s</span>):<br>    r0=(s&gt;&gt;<span class="hljs-number">24</span>)&amp;<span class="hljs-number">0xff</span><br>    r1=(s&gt;&gt;<span class="hljs-number">16</span>)&amp;<span class="hljs-number">0xff</span><br>    r2=(s&gt;&gt;<span class="hljs-number">8</span>)&amp;<span class="hljs-number">0xff</span><br>    r3=s&amp;<span class="hljs-number">0xff</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mulx</span>(<span class="hljs-params">V, c</span>):<br>        <span class="hljs-keyword">return</span> (V &lt;&lt; <span class="hljs-number">1</span>) ^ (c*LShR(V, <span class="hljs-number">7</span>))&amp; <span class="hljs-number">0xff</span><br>    solver=Solver()<br>    sqw0,sqw1,sqw2,sqw3=BitVecs(<span class="hljs-string">&#x27;sqw0 sqw1 sqw2 sqw3&#x27;</span>, <span class="hljs-number">8</span>)<br>    solver.add(r0 == (mulx(sqw0, <span class="hljs-number">0x69</span>) ^ sqw1 ^ sqw2 ^mulx(sqw3, <span class="hljs-number">0x69</span>) ^ sqw3) &amp; <span class="hljs-number">0xff</span>)<br>    solver.add(r1 == (mulx(sqw0, <span class="hljs-number">0x69</span>) ^ sqw0 ^ mulx(sqw1, <span class="hljs-number">0x69</span>) ^ sqw2 ^ sqw3) &amp; <span class="hljs-number">0xff</span>)<br>    solver.add(r2 == (sqw0 ^ mulx(sqw1, <span class="hljs-number">0x69</span>) ^ sqw1 ^ mulx(sqw2, <span class="hljs-number">0x69</span>) ^ sqw3) &amp; <span class="hljs-number">0xff</span>)<br>    solver.add(r3 == (sqw0 ^ sqw1 ^ mulx(sqw2, <span class="hljs-number">0x69</span>) ^ sqw2 ^ mulx(sqw3, <span class="hljs-number">0x69</span>)) &amp; <span class="hljs-number">0xff</span>)<br><br>    <span class="hljs-keyword">if</span> solver.check()==sat:<br>        res=solver.model()<br>        __sq=sq.tolist()<br>        w0=__sq.index(res[sqw0].py_value())<br>        w1=__sq.index(res[sqw1].py_value())<br>        w2=__sq.index(res[sqw2].py_value())<br>        w3=__sq.index(res[sqw3].py_value())<br>        <span class="hljs-keyword">return</span> (w0 &lt;&lt; <span class="hljs-number">24</span>) | (w1 &lt;&lt; <span class="hljs-number">16</span>) | (w2 &lt;&lt; <span class="hljs-number">8</span>) | w3<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<p>题目中我们可以看到lfsr的值都被添加进S中了，所以可以认为S序列包含了lfsr的各个状态的值(可能最开始的没有，但不重要)。<br>接下来就是对lfsr_keystream_mode的逆向了。lfsr是由前面的3个值来推出下一个值的，也就是说我们需要3个值，剩下的值才能被确定。我同样采取解方程的方式来求解其中任意一个值。但我在实际求解的时候发现S11的值大部分情况求解不对，暂时也不知道是什么的问题。但在最后只需要稍微改动一下就可以避免去用de_lfsr_keystream_mode来求解S11，S11还可以由别的数据来确定。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">de_lfsr_keystream_mode</span>(<span class="hljs-params">S0, S2, S11, S16</span>):<br>    <span class="hljs-keyword">if</span> S0 == <span class="hljs-string">&#x27;&#x27;</span>:<br>        S0 = BitVec(<span class="hljs-string">&#x27;S0&#x27;</span>, <span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">else</span>:<br>        S0 = np.uint32(S0)<br>    <span class="hljs-keyword">if</span> S2 == <span class="hljs-string">&#x27;&#x27;</span>:<br>        S2 = BitVec(<span class="hljs-string">&#x27;S2&#x27;</span>, <span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">else</span>:<br>        S2 = np.uint32(S2)<br>    <span class="hljs-keyword">if</span> S11 == <span class="hljs-string">&#x27;&#x27;</span>:<br>        S11 = BitVec(<span class="hljs-string">&#x27;S11&#x27;</span>, <span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">else</span>:<br>        S11 = np.uint32(S11)<br>    <span class="hljs-keyword">if</span> S16 == <span class="hljs-string">&#x27;&#x27;</span>:<br>        S16 = BitVec(<span class="hljs-string">&#x27;S16&#x27;</span>, <span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">else</span>:<br>        S16 = np.uint32(S16)<br>        <br>    solver = Solver()<br>    solver.add(S16 == lfsr_keystream_mode(S0, S2, S11))<br><br>    <span class="hljs-keyword">if</span> solver.check() == sat:<br>        res = solver.model()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(S0, BitVecRef):<br>            <span class="hljs-keyword">return</span> res[S0].as_long()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(S2, BitVecRef):<br>            <span class="hljs-keyword">return</span> res[S2].as_long()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(S11, BitVecRef):<br>            <span class="hljs-keyword">return</span> res[S11].as_long()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(S16, BitVecRef):<br>            <span class="hljs-keyword">return</span> res[S16].as_long()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure>
<p>写完了这三个函数的逆向求解的函数，我们来理一下fsm,lfsr,S,F,key_stream之间的关系。<br>前面我们提到lfsr的值都被添加进了S，所以可以用S来代替lfsr序列，大致是如下的对应关系。<br><img src="/2025/02/01/2024%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B/3.png" srcset="/img/loading.gif" lazyload><br>所以接下来我就用<code>S[i+k]</code>来表示第i+1轮第k+1个lfsr的值，以<code>S[0+0]</code>为第1轮第1个lfsr的值。<br>然后是fsm，fsm的值的推导是在clock_fsm中，在generate_keystream里调用完clock_fsm函数后，R1,R2,R3添加的是第i+2轮的fsm的值，而S添加的是第i+1轮第一个lfsr的值，return的F是第i+1轮的fsm,lfsr的值得出的。但在for循环之前R1,R2,R3先append了一轮，所以每次for循环就类似于下面这种情况:<br><img src="/2025/02/01/2024%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B/4.png" srcset="/img/loading.gif" lazyload><br>所以接下来我用<code>fsm[i][k]</code>来表示第<code>i+1</code>轮<code>R(k+1)</code>的值，以<code>fsm[0][0]</code>为第1轮R1的值，也就是<code>R1[0]</code>。<br>那么，各个数据之间的关系就是:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs link">F[i]是S[i+15],fsm[i][0],fsm[i][1]得出的<br>fsm[i+1][2]是fsm[i][1]得出的<br>fsm[i+1][1]是fsm[i][0]得出的<br>fsm[i+1][0]是fsm[i][1],fsm[i][2],S[i+5]得出的<br></code></pre></td></tr></table></figure>
<p>请牢记这些关系，等下会经常用到。</p>
<p>我在初始化key_stream,fsm,S,F的时候是用的空字符串来初始化，因为它能在我尝试用未知的值来推别的值时报错，来让我更好的发现错误。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">key_stream=[<span class="hljs-string">&#x27;&#x27;</span>]*<span class="hljs-number">150</span><br>fsm=[[<span class="hljs-string">&#x27;&#x27;</span>]*<span class="hljs-number">3</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">150</span>)]<br>S=[<span class="hljs-string">&#x27;&#x27;</span>]*<span class="hljs-number">150</span><br>F=[<span class="hljs-string">&#x27;&#x27;</span>]*<span class="hljs-number">150</span><br></code></pre></td></tr></table></figure>
<p>接下来我们来写check函数，顾名思义，就是检查能否推出别的值。<br>首先是S序列，我们可以由任意三个值推出剩下的一个值。所以我们要的数据就是<code>S[i],S[i+2],S[i+11],S[i+15+1]</code>(lfsr序列推出的下一个值是赋S[i+15+1]的，而不是S[i+15]，不懂的再想一下)。<br>checkS:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#检查S序列能否向后推导或者推出前面的某一个值</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkS</span>():<br>    flag=<span class="hljs-literal">False</span><span class="hljs-comment">#标记是否有check出新的值</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(S)-<span class="hljs-number">16</span>):<br>        __l=[<span class="hljs-built_in">type</span>(S[i]),<span class="hljs-built_in">type</span>(S[i+<span class="hljs-number">2</span>]),<span class="hljs-built_in">type</span>(S[i+<span class="hljs-number">11</span>]),<span class="hljs-built_in">type</span>(S[i+<span class="hljs-number">15</span>+<span class="hljs-number">1</span>])]<br>        <span class="hljs-keyword">if</span> __l.count(<span class="hljs-built_in">int</span>)==<span class="hljs-number">3</span>:<br>            flag=<span class="hljs-literal">True</span><br>            <span class="hljs-keyword">if</span> __l.index(<span class="hljs-built_in">str</span>)==<span class="hljs-number">3</span>:<br>                S[i+<span class="hljs-number">15</span>+<span class="hljs-number">1</span>]=<span class="hljs-built_in">int</span>(lfsr_keystream_mode(np.uint32(S[i+<span class="hljs-number">0</span>]),np.uint32(S[i+<span class="hljs-number">2</span>]),np.uint32(S[i+<span class="hljs-number">11</span>])))<br>            <span class="hljs-keyword">else</span>:<br>                __index=[i,i+<span class="hljs-number">2</span>,i+<span class="hljs-number">11</span>,i+<span class="hljs-number">15</span>+<span class="hljs-number">1</span>]<br>                S[__index[__l.index(<span class="hljs-built_in">str</span>)]]=de_lfsr_keystream_mode(S[i],S[i+<span class="hljs-number">2</span>],S[i+<span class="hljs-number">11</span>],S[i+<span class="hljs-number">15</span>+<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">return</span> flag<br></code></pre></td></tr></table></figure>
<p>再提一下，我的de_lfsr_keystream_mode并不能很好的解<code>S[i+11]</code>是未知数的情况，如果你发现了我的de_lfsr_keystream_mode的错误请和我说一下。我们最后只需要更改一下checkS的调用顺序就能避免这种情况，很神奇。</p>
<p>然后是fsm序列的向前逆向推导和向后推导，对于<code>fsm[i][0]</code>，只要知道其中任意三个值就可以推出剩下的一个值。<br>checkFSM:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#检查fsm能否向前或向后推导</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkFSM</span>():<br>    flag=<span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(fsm)-<span class="hljs-number">5</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">1</span>])==<span class="hljs-built_in">int</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">2</span>])!=<span class="hljs-built_in">int</span>:<span class="hljs-comment">#fsm[i][1] -s2-&gt; fsm[i+1][2]</span><br>            fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">2</span>]=<span class="hljs-built_in">int</span>(s2(fsm[i][<span class="hljs-number">1</span>]))<br>            flag=<span class="hljs-literal">True</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">0</span>])==<span class="hljs-built_in">int</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">1</span>])!=<span class="hljs-built_in">int</span>:<span class="hljs-comment">#fsm[i][0] -s1-&gt; fsm[i+1][1]</span><br>            fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]=<span class="hljs-built_in">int</span>(s1(fsm[i][<span class="hljs-number">0</span>]))<br>            flag=<span class="hljs-literal">True</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">1</span>])!=<span class="hljs-built_in">int</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">2</span>])==<span class="hljs-built_in">int</span>:<span class="hljs-comment">#fsm[i][1] -de_s2-&gt; fsm[i+1][2]</span><br>            fsm[i][<span class="hljs-number">1</span>]=de_s2(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">2</span>])<br>            flag=<span class="hljs-literal">True</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">0</span>])!=<span class="hljs-built_in">int</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">1</span>])==<span class="hljs-built_in">int</span>:<span class="hljs-comment">#fsm[i][0] -de_s1-&gt; fsm[i+1][1]</span><br>            fsm[i][<span class="hljs-number">0</span>]=de_s1(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">1</span>])<br>            flag=<span class="hljs-literal">True</span><br>        <span class="hljs-comment">#对于fsm[i][0]，只要知道其中任意三个值就可以推出剩下的一个值，所以顺带都写在这了</span><br>        __l=[<span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">1</span>]),<span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">2</span>]),<span class="hljs-built_in">type</span>(S[i+<span class="hljs-number">5</span>]),<span class="hljs-built_in">type</span>(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])]<br>        <span class="hljs-keyword">if</span> __l.count(<span class="hljs-built_in">int</span>)==<span class="hljs-number">3</span>:<br>            flag=<span class="hljs-literal">True</span><br>            __=__l.index(<span class="hljs-built_in">str</span>)<br>            <span class="hljs-keyword">if</span> __==<span class="hljs-number">0</span>:<br>                fsm[i][<span class="hljs-number">1</span>]=(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]-(fsm[i][<span class="hljs-number">2</span>]^S[i+<span class="hljs-number">5</span>]))%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">1</span>:<br>                fsm[i][<span class="hljs-number">2</span>]=((fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]-fsm[i][<span class="hljs-number">1</span>])^S[i+<span class="hljs-number">5</span>])%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">2</span>:<br>                S[i+<span class="hljs-number">5</span>]=((fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]-fsm[i][<span class="hljs-number">1</span>])^fsm[i][<span class="hljs-number">2</span>])%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">3</span>:<br>                fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]=(fsm[i][<span class="hljs-number">1</span>]+(fsm[i][<span class="hljs-number">2</span>]^S[i+<span class="hljs-number">5</span>]))%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>    <span class="hljs-keyword">return</span> flag<br></code></pre></td></tr></table></figure>

<p>在clock_fsm中还有对F的赋值，我们也可以由任意3个值推出剩下的<br>checkFSFSM:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#检查clock_fsm里面的F的推导，只要知道其中任意三个值就可以推出剩下的一个值</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkFSFSM</span>():<br>    flag=<span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(S)-<span class="hljs-number">15</span>):<br>        __l=[<span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">0</span>]),<span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">1</span>]),<span class="hljs-built_in">type</span>(F[i]),<span class="hljs-built_in">type</span>(S[i+<span class="hljs-number">15</span>])]<br>        <span class="hljs-keyword">if</span> __l.count(<span class="hljs-built_in">int</span>)==<span class="hljs-number">3</span>:<br>            flag=<span class="hljs-literal">True</span><br>            __=__l.index(<span class="hljs-built_in">str</span>)<br>            <span class="hljs-keyword">if</span> __==<span class="hljs-number">0</span>:<br>                fsm[i][<span class="hljs-number">0</span>]=((F[i]^fsm[i][<span class="hljs-number">1</span>])-S[i+<span class="hljs-number">15</span>])%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">1</span>:<br>                fsm[i][<span class="hljs-number">1</span>]=(F[i]^(S[i+<span class="hljs-number">15</span>]+fsm[i][<span class="hljs-number">0</span>]))%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">2</span>:<br>                F[i]=((S[i+<span class="hljs-number">15</span>]+fsm[i][<span class="hljs-number">0</span>])^fsm[i][<span class="hljs-number">1</span>])%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">3</span>:<br>                S[i+<span class="hljs-number">15</span>]=((F[i]^fsm[i][<span class="hljs-number">1</span>])-fsm[i][<span class="hljs-number">0</span>])%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>    <span class="hljs-keyword">return</span> flag<br></code></pre></td></tr></table></figure>

<p>最后就是key_stream了，知道key_stream,F,S(也就是lfsr)任意2个可以推出剩下的一个<br>checkFSSTREAM:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#检查F,S,key_stream的互相之间的推导，知道任意2个可以推出剩下的一个</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkFSSTREAM</span>():<br>    flag=<span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key_stream)):<br>        __l=[<span class="hljs-built_in">type</span>(key_stream[i]),<span class="hljs-built_in">type</span>(F[i]),<span class="hljs-built_in">type</span>(S[i])]<br>        <span class="hljs-keyword">if</span> __l.count(<span class="hljs-built_in">int</span>)==<span class="hljs-number">2</span>:<br>            flag=<span class="hljs-literal">True</span><br>            __=__l.index(<span class="hljs-built_in">str</span>)<br>            <span class="hljs-keyword">if</span> __==<span class="hljs-number">0</span>:<br>                key_stream[i]=F[i]^S[i]<br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">1</span>:<br>                F[i]=key_stream[i]^S[i]<br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">2</span>:<br>                S[i]=key_stream[i]^F[i]<br>    <span class="hljs-keyword">return</span> flag<br></code></pre></td></tr></table></figure>

<p>最后把这些函数全丢进一个函数里调用就好了，我本地调试时加了一个checkCORRECT来检验正确性。<br>因为我de_lfsr_keystream_mode的问题，所以把checkS尽量在后面调用。<br>checkALL():</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkALL</span>():<br>    flag=checkFSM()<br>    flag=flag <span class="hljs-keyword">or</span> checkFSFSM()<br>    flag=flag <span class="hljs-keyword">or</span> checkFSSTREAM()<br>    flag=flag <span class="hljs-keyword">or</span> checkS()<br>    checkCORRECT()<br>    <span class="hljs-keyword">return</span> flag<br></code></pre></td></tr></table></figure>
<p>只需要不断调用checkALL直到返回值是False即可。<br>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> z3 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-comment"># 定义 S-box</span><br>sr = np.array([<br>    <span class="hljs-number">0x63</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0xf2</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0xc5</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0x2b</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0xd7</span>, <span class="hljs-number">0xab</span>, <span class="hljs-number">0x76</span>,<br>    <span class="hljs-number">0xca</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0xd4</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x9c</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xc0</span>,<br>    <span class="hljs-number">0xb7</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x15</span>,<br>    <span class="hljs-number">0x04</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x9a</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0xe2</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xb2</span>, <span class="hljs-number">0x75</span>,<br>    <span class="hljs-number">0x09</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0xd6</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x84</span>,<br>    <span class="hljs-number">0x53</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0x5b</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0xcb</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0xcf</span>,<br>    <span class="hljs-number">0xd0</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0xa8</span>,<br>    <span class="hljs-number">0x51</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0xbc</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0xd2</span>,<br>    <span class="hljs-number">0xcd</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xec</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0x7e</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0x64</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0x73</span>,<br>    <span class="hljs-number">0x60</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0xdb</span>,<br>    <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0x3a</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x5c</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xe4</span>, <span class="hljs-number">0x79</span>,<br>    <span class="hljs-number">0xe7</span>, <span class="hljs-number">0xc8</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x56</span>, <span class="hljs-number">0xf4</span>, <span class="hljs-number">0xea</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x08</span>,<br>    <span class="hljs-number">0xba</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x25</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0xb4</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x8a</span>,<br>    <span class="hljs-number">0x70</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xb9</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x9e</span>,<br>    <span class="hljs-number">0xe1</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xdf</span>,<br>    <span class="hljs-number">0x8c</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0xb0</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0x16</span><br>], dtype=np.uint8)<br><br>sq = np.array([<br>    <span class="hljs-number">0x25</span>, <span class="hljs-number">0x24</span>, <span class="hljs-number">0x73</span>, <span class="hljs-number">0x67</span>, <span class="hljs-number">0xd7</span>, <span class="hljs-number">0xae</span>, <span class="hljs-number">0x5c</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0xcb</span>, <span class="hljs-number">0x7d</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xdb</span>,<br>    <span class="hljs-number">0xe4</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x49</span>, <span class="hljs-number">0x4f</span>, <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x88</span>, <span class="hljs-number">0xe8</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0x65</span>, <span class="hljs-number">0xe2</span>,<br>    <span class="hljs-number">0xd8</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0xcc</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0x11</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xd2</span>, <span class="hljs-number">0xac</span>, <span class="hljs-number">0xe3</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0x15</span>, <span class="hljs-number">0x1b</span>, <span class="hljs-number">0xb9</span>,<br>    <span class="hljs-number">0xb2</span>, <span class="hljs-number">0x80</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0x2e</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0x89</span>, <span class="hljs-number">0xd4</span>,<br>    <span class="hljs-number">0xca</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x46</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0xdd</span>, <span class="hljs-number">0x44</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0x20</span>, <span class="hljs-number">0x4c</span>, <span class="hljs-number">0x64</span>,<br>    <span class="hljs-number">0x83</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0x68</span>, <span class="hljs-number">0x42</span>, <span class="hljs-number">0x13</span>, <span class="hljs-number">0xb4</span>, <span class="hljs-number">0x41</span>, <span class="hljs-number">0xcd</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0xc6</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0x6d</span>, <span class="hljs-number">0x4d</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0xf4</span>,<br>    <span class="hljs-number">0x8d</span>, <span class="hljs-number">0xb0</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0x43</span>, <span class="hljs-number">0x45</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x36</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xfa</span>,<br>    <span class="hljs-number">0xbc</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x08</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0x1d</span>, <span class="hljs-number">0x55</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0xc5</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0x23</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x7a</span>, <span class="hljs-number">0x92</span>, <span class="hljs-number">0xff</span>, <span class="hljs-number">0x5b</span>, <span class="hljs-number">0x5a</span>,<br>    <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x9a</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0x7e</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x8a</span>, <span class="hljs-number">0xb6</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xf5</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0xdc</span>,<br>    <span class="hljs-number">0x03</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x0c</span>, <span class="hljs-number">0x39</span>, <span class="hljs-number">0xf1</span>, <span class="hljs-number">0xb8</span>, <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0xf2</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x81</span>, <span class="hljs-number">0x32</span>, <span class="hljs-number">0xa0</span>, <span class="hljs-number">0x00</span>,<br>    <span class="hljs-number">0x06</span>, <span class="hljs-number">0xce</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0xea</span>, <span class="hljs-number">0xb7</span>, <span class="hljs-number">0x17</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0x79</span>, <span class="hljs-number">0xd6</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0xbf</span>, <span class="hljs-number">0x8b</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x53</span>,<br>    <span class="hljs-number">0x63</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x35</span>, <span class="hljs-number">0x2c</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0xd3</span>, <span class="hljs-number">0x94</span>, <span class="hljs-number">0xa5</span>, <span class="hljs-number">0x7c</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0xbd</span>,<br>    <span class="hljs-number">0xd9</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x54</span>, <span class="hljs-number">0x0b</span>, <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xc8</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0x14</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x9c</span>,<br>    <span class="hljs-number">0xdf</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0xda</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x74</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xab</span>, <span class="hljs-number">0x26</span>, <span class="hljs-number">0x61</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x2b</span>,<br>    <span class="hljs-number">0xad</span>, <span class="hljs-number">0x99</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xec</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x12</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x3e</span>, <span class="hljs-number">0x18</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x3a</span>,<br>    <span class="hljs-number">0x56</span>, <span class="hljs-number">0xe1</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xa8</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0x86</span><br>], dtype=np.uint8)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mulx</span>(<span class="hljs-params">V, c</span>):<br>    <span class="hljs-keyword">return</span> (V &lt;&lt; <span class="hljs-number">1</span>) ^ (c*((V&amp;<span class="hljs-number">0x80</span>)&gt;&gt;<span class="hljs-number">7</span>))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mulx_pow</span>(<span class="hljs-params">V, i, c</span>):<br>    <span class="hljs-keyword">if</span> i == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> V<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> mulx(mulx_pow(V, i - <span class="hljs-number">1</span>, c), c)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">mul_alpha</span>(<span class="hljs-params">c</span>):<br>    r0 = mulx_pow(c, <span class="hljs-number">23</span>, <span class="hljs-number">0xa9</span>) &amp; <span class="hljs-number">0xff</span><br>    r1 = mulx_pow(c, <span class="hljs-number">245</span>, <span class="hljs-number">0xa9</span>) &amp; <span class="hljs-number">0xff</span><br>    r2 = mulx_pow(c, <span class="hljs-number">48</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>    r3 = mulx_pow(c, <span class="hljs-number">239</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">return</span> (r0 &lt;&lt; <span class="hljs-number">24</span>) | (r1 &lt;&lt; <span class="hljs-number">16</span>) | (r2 &lt;&lt; <span class="hljs-number">8</span>) | r3<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">div_alpha</span>(<span class="hljs-params">c</span>):<br>    r0 = mulx_pow(c, <span class="hljs-number">16</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>    r1 = mulx_pow(c, <span class="hljs-number">39</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>    r2 = mulx_pow(c, <span class="hljs-number">6</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>    r3 = mulx_pow(c, <span class="hljs-number">64</span>, <span class="hljs-number">0xa9</span>) &amp;  <span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">return</span> (r0 &lt;&lt; <span class="hljs-number">24</span>) | (r1 &lt;&lt; <span class="hljs-number">16</span>) | (r2 &lt;&lt; <span class="hljs-number">8</span>) | r3<br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s1</span>(<span class="hljs-params">w</span>):<br>    w0 = (w &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span><br>    w1 = (w &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span><br>    w2 = (w &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span><br>    w3 = w &amp; <span class="hljs-number">0xff</span><br><br>    r0 = (mulx(sr[w0], <span class="hljs-number">0x1b</span>) ^ sr[w1] ^ sr[w2] ^ mulx(sr[w3], <span class="hljs-number">0x1b</span>) ^ sr[w3]) &amp; <span class="hljs-number">0xff</span><br>    r1 = (mulx(sr[w0], <span class="hljs-number">0x1b</span>) ^ sr[w0] ^ mulx(sr[w1], <span class="hljs-number">0x1b</span>) ^ sr[w2] ^ sr[w3]) &amp; <span class="hljs-number">0xff</span><br>    r2 = (sr[w0] ^ mulx(sr[w1], <span class="hljs-number">0x1b</span>) ^ sr[w1] ^ mulx(sr[w2], <span class="hljs-number">0x1b</span>) ^ sr[w3]) &amp; <span class="hljs-number">0xff</span><br>    r3 = (sr[w0] ^ sr[w1] ^ mulx(sr[w2], <span class="hljs-number">0x1b</span>) ^ sr[w2] ^ mulx(sr[w3], <span class="hljs-number">0x1b</span>)) &amp; <span class="hljs-number">0xff</span><br><br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(r0) &lt;&lt; <span class="hljs-number">24</span>) | (<span class="hljs-built_in">int</span>(r1) &lt;&lt; <span class="hljs-number">16</span>) | (<span class="hljs-built_in">int</span>(r2) &lt;&lt; <span class="hljs-number">8</span>) | <span class="hljs-built_in">int</span>(r3)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">s2</span>(<span class="hljs-params">w</span>):<br>    w0 = (w &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span><br>    w1 = (w &gt;&gt; <span class="hljs-number">16</span>) &amp; <span class="hljs-number">0xff</span><br>    w2 = (w &gt;&gt; <span class="hljs-number">8</span>) &amp; <span class="hljs-number">0xff</span><br>    w3 = w &amp; <span class="hljs-number">0xff</span><br><br>    r0 = (mulx(sq[w0], <span class="hljs-number">0x69</span>) ^ sq[w1] ^ sq[w2] ^ mulx(sq[w3], <span class="hljs-number">0x69</span>) ^ sq[w3]) &amp; <span class="hljs-number">0xff</span><br>    r1 = (mulx(sq[w0], <span class="hljs-number">0x69</span>) ^ sq[w0] ^ mulx(sq[w1], <span class="hljs-number">0x69</span>) ^ sq[w2] ^ sq[w3]) &amp; <span class="hljs-number">0xff</span><br>    r2 = (sq[w0] ^ mulx(sq[w1], <span class="hljs-number">0x69</span>) ^ sq[w1] ^ mulx(sq[w2], <span class="hljs-number">0x69</span>) ^ sq[w3]) &amp; <span class="hljs-number">0xff</span><br>    r3 = (sq[w0] ^ sq[w1] ^ mulx(sq[w2], <span class="hljs-number">0x69</span>) ^ sq[w2] ^ mulx(sq[w3], <span class="hljs-number">0x69</span>)) &amp; <span class="hljs-number">0xff</span><br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">int</span>(r0) &lt;&lt; <span class="hljs-number">24</span>) | (<span class="hljs-built_in">int</span>(r1) &lt;&lt; <span class="hljs-number">16</span>) | (<span class="hljs-built_in">int</span>(r2) &lt;&lt; <span class="hljs-number">8</span>) | <span class="hljs-built_in">int</span>(r3)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">clock_fsm</span>(<span class="hljs-params">s15, s5</span>):<br>    F = (s15 + fsm[<span class="hljs-number">0</span>]) ^ fsm[<span class="hljs-number">1</span>]<br>    r = fsm[<span class="hljs-number">1</span>] + (fsm[<span class="hljs-number">2</span>] ^ s5)<br>    fsm[<span class="hljs-number">2</span>] = s2(fsm[<span class="hljs-number">1</span>])<br>    fsm[<span class="hljs-number">1</span>] = s1(fsm[<span class="hljs-number">0</span>])<br>    fsm[<span class="hljs-number">0</span>] = r<br>    <span class="hljs-keyword">return</span> F<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">lfsr_keystream_mode</span>(<span class="hljs-params">S0,S2,S11</span>):<br>    v = (S0 &lt;&lt; <span class="hljs-number">8</span>) ^ mul_alpha((S0 &gt;&gt; <span class="hljs-number">24</span>) &amp; <span class="hljs-number">0xff</span>) ^ S2 ^ (S11 &gt;&gt; <span class="hljs-number">8</span>) ^ \<br>        div_alpha(S11 &amp; <span class="hljs-number">0xff</span>)<br>    <span class="hljs-keyword">return</span> v<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">de_lfsr_keystream_mode</span>(<span class="hljs-params">S0, S2, S11, S16</span>):<br>    <span class="hljs-keyword">if</span> S0 == <span class="hljs-string">&#x27;&#x27;</span>:<br>        S0 = BitVec(<span class="hljs-string">&#x27;S0&#x27;</span>, <span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">else</span>:<br>        S0 = np.uint32(S0)<br>    <span class="hljs-keyword">if</span> S2 == <span class="hljs-string">&#x27;&#x27;</span>:<br>        S2 = BitVec(<span class="hljs-string">&#x27;S2&#x27;</span>, <span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">else</span>:<br>        S2 = np.uint32(S2)<br>    <span class="hljs-keyword">if</span> S11 == <span class="hljs-string">&#x27;&#x27;</span>:<br>        S11 = BitVec(<span class="hljs-string">&#x27;S11&#x27;</span>, <span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">else</span>:<br>        S11 = np.uint32(S11)<br>    <span class="hljs-keyword">if</span> S16 == <span class="hljs-string">&#x27;&#x27;</span>:<br>        S16 = BitVec(<span class="hljs-string">&#x27;S16&#x27;</span>, <span class="hljs-number">32</span>)<br>    <span class="hljs-keyword">else</span>:<br>        S16 = np.uint32(S16)<br>        <br>    solver = Solver()<br>    solver.add(S16 == lfsr_keystream_mode(S0, S2, S11))<br><br>    <span class="hljs-keyword">if</span> solver.check() == sat:<br>        res = solver.model()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(S0, BitVecRef):<br>            <span class="hljs-keyword">return</span> res[S0].as_long()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(S2, BitVecRef):<br>            <span class="hljs-keyword">return</span> res[S2].as_long()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(S11, BitVecRef):<br>            <span class="hljs-keyword">return</span> res[S11].as_long()<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">isinstance</span>(S16, BitVecRef):<br>            <span class="hljs-keyword">return</span> res[S16].as_long()<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">de_s1</span>(<span class="hljs-params">s</span>):<br>    r0=(s&gt;&gt;<span class="hljs-number">24</span>)&amp;<span class="hljs-number">0xff</span><br>    r1=(s&gt;&gt;<span class="hljs-number">16</span>)&amp;<span class="hljs-number">0xff</span><br>    r2=(s&gt;&gt;<span class="hljs-number">8</span>)&amp;<span class="hljs-number">0xff</span><br>    r3=s&amp;<span class="hljs-number">0xff</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mulx</span>(<span class="hljs-params">V, c</span>):<br>        <span class="hljs-keyword">return</span> (V &lt;&lt; <span class="hljs-number">1</span>) ^ (c*LShR(V, <span class="hljs-number">7</span>))&amp; <span class="hljs-number">0xff</span><br>    solver=Solver()<br>    srw0,srw1,srw2,srw3=BitVecs(<span class="hljs-string">&#x27;srw0 srw1 srw2 srw3&#x27;</span>, <span class="hljs-number">8</span>)<br>    solver.add(r0 == (mulx(srw0, <span class="hljs-number">0x1b</span>) ^ srw1 ^ srw2 ^mulx(srw3, <span class="hljs-number">0x1b</span>) ^ srw3) &amp; <span class="hljs-number">0xff</span>)<br>    solver.add(r1 == (mulx(srw0, <span class="hljs-number">0x1b</span>) ^ srw0 ^ mulx(srw1, <span class="hljs-number">0x1b</span>) ^ srw2 ^ srw3) &amp; <span class="hljs-number">0xff</span>)<br>    solver.add(r2 == (srw0 ^ mulx(srw1, <span class="hljs-number">0x1b</span>) ^ srw1 ^ mulx(srw2, <span class="hljs-number">0x1b</span>) ^ srw3) &amp; <span class="hljs-number">0xff</span>)<br>    solver.add(r3 == (srw0 ^ srw1 ^ mulx(srw2, <span class="hljs-number">0x1b</span>) ^ srw2 ^ mulx(srw3, <span class="hljs-number">0x1b</span>)) &amp; <span class="hljs-number">0xff</span>)<br><br>    <span class="hljs-keyword">if</span> solver.check()==sat:<br>        res=solver.model()<br>        __sr=sr.tolist()<br>        w0=__sr.index(res[srw0].py_value())<br>        w1=__sr.index(res[srw1].py_value())<br>        w2=__sr.index(res[srw2].py_value())<br>        w3=__sr.index(res[srw3].py_value())<br>        <span class="hljs-keyword">return</span> (w0 &lt;&lt; <span class="hljs-number">24</span>) | (w1 &lt;&lt; <span class="hljs-number">16</span>) | (w2 &lt;&lt; <span class="hljs-number">8</span>) | w3<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">de_s2</span>(<span class="hljs-params">s</span>):<br>    r0=(s&gt;&gt;<span class="hljs-number">24</span>)&amp;<span class="hljs-number">0xff</span><br>    r1=(s&gt;&gt;<span class="hljs-number">16</span>)&amp;<span class="hljs-number">0xff</span><br>    r2=(s&gt;&gt;<span class="hljs-number">8</span>)&amp;<span class="hljs-number">0xff</span><br>    r3=s&amp;<span class="hljs-number">0xff</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mulx</span>(<span class="hljs-params">V, c</span>):<br>        <span class="hljs-keyword">return</span> (V &lt;&lt; <span class="hljs-number">1</span>) ^ (c*LShR(V, <span class="hljs-number">7</span>))&amp; <span class="hljs-number">0xff</span><br>    solver=Solver()<br>    sqw0,sqw1,sqw2,sqw3=BitVecs(<span class="hljs-string">&#x27;sqw0 sqw1 sqw2 sqw3&#x27;</span>, <span class="hljs-number">8</span>)<br>    solver.add(r0 == (mulx(sqw0, <span class="hljs-number">0x69</span>) ^ sqw1 ^ sqw2 ^mulx(sqw3, <span class="hljs-number">0x69</span>) ^ sqw3) &amp; <span class="hljs-number">0xff</span>)<br>    solver.add(r1 == (mulx(sqw0, <span class="hljs-number">0x69</span>) ^ sqw0 ^ mulx(sqw1, <span class="hljs-number">0x69</span>) ^ sqw2 ^ sqw3) &amp; <span class="hljs-number">0xff</span>)<br>    solver.add(r2 == (sqw0 ^ mulx(sqw1, <span class="hljs-number">0x69</span>) ^ sqw1 ^ mulx(sqw2, <span class="hljs-number">0x69</span>) ^ sqw3) &amp; <span class="hljs-number">0xff</span>)<br>    solver.add(r3 == (sqw0 ^ sqw1 ^ mulx(sqw2, <span class="hljs-number">0x69</span>) ^ sqw2 ^ mulx(sqw3, <span class="hljs-number">0x69</span>)) &amp; <span class="hljs-number">0xff</span>)<br><br>    <span class="hljs-keyword">if</span> solver.check()==sat:<br>        res=solver.model()<br>        __sq=sq.tolist()<br>        w0=__sq.index(res[sqw0].py_value())<br>        w1=__sq.index(res[sqw1].py_value())<br>        w2=__sq.index(res[sqw2].py_value())<br>        w3=__sq.index(res[sqw3].py_value())<br>        <span class="hljs-keyword">return</span> (w0 &lt;&lt; <span class="hljs-number">24</span>) | (w1 &lt;&lt; <span class="hljs-number">16</span>) | (w2 &lt;&lt; <span class="hljs-number">8</span>) | w3<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><span class="hljs-comment">#检查S序列能否向后推导或者推出前面的某一个值</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkS</span>():<br>    flag=<span class="hljs-literal">False</span><span class="hljs-comment">#标记是否有check出新的值</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(S)-<span class="hljs-number">16</span>):<br>        __l=[<span class="hljs-built_in">type</span>(S[i]),<span class="hljs-built_in">type</span>(S[i+<span class="hljs-number">2</span>]),<span class="hljs-built_in">type</span>(S[i+<span class="hljs-number">11</span>]),<span class="hljs-built_in">type</span>(S[i+<span class="hljs-number">15</span>+<span class="hljs-number">1</span>])]<br>        <span class="hljs-keyword">if</span> __l.count(<span class="hljs-built_in">int</span>)==<span class="hljs-number">3</span>:<br>            flag=<span class="hljs-literal">True</span><br>            <span class="hljs-keyword">if</span> __l.index(<span class="hljs-built_in">str</span>)==<span class="hljs-number">3</span>:<br>                S[i+<span class="hljs-number">15</span>+<span class="hljs-number">1</span>]=<span class="hljs-built_in">int</span>(lfsr_keystream_mode(np.uint32(S[i+<span class="hljs-number">0</span>]),np.uint32(S[i+<span class="hljs-number">2</span>]),np.uint32(S[i+<span class="hljs-number">11</span>])))<br>            <span class="hljs-keyword">else</span>:<br>                __index=[i,i+<span class="hljs-number">2</span>,i+<span class="hljs-number">11</span>,i+<span class="hljs-number">15</span>+<span class="hljs-number">1</span>]<br>                S[__index[__l.index(<span class="hljs-built_in">str</span>)]]=de_lfsr_keystream_mode(S[i],S[i+<span class="hljs-number">2</span>],S[i+<span class="hljs-number">11</span>],S[i+<span class="hljs-number">15</span>+<span class="hljs-number">1</span>])<br>    <span class="hljs-keyword">return</span> flag<br><br><span class="hljs-comment">#检查fsm能否向前或向后推导</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkFSM</span>():<br>    flag=<span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(fsm)-<span class="hljs-number">5</span>):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">1</span>])==<span class="hljs-built_in">int</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">2</span>])!=<span class="hljs-built_in">int</span>:<span class="hljs-comment">#fsm[i][1] -s2-&gt; fsm[i+1][2]</span><br>            fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">2</span>]=<span class="hljs-built_in">int</span>(s2(fsm[i][<span class="hljs-number">1</span>]))<br>            flag=<span class="hljs-literal">True</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">0</span>])==<span class="hljs-built_in">int</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">1</span>])!=<span class="hljs-built_in">int</span>:<span class="hljs-comment">#fsm[i][0] -s1-&gt; fsm[i+1][1]</span><br>            fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]=<span class="hljs-built_in">int</span>(s1(fsm[i][<span class="hljs-number">0</span>]))<br>            flag=<span class="hljs-literal">True</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">1</span>])!=<span class="hljs-built_in">int</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">2</span>])==<span class="hljs-built_in">int</span>:<span class="hljs-comment">#fsm[i][1] -de_s2-&gt; fsm[i+1][2]</span><br>            fsm[i][<span class="hljs-number">1</span>]=de_s2(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">2</span>])<br>            flag=<span class="hljs-literal">True</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">0</span>])!=<span class="hljs-built_in">int</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">type</span>(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">1</span>])==<span class="hljs-built_in">int</span>:<span class="hljs-comment">#fsm[i][0] -de_s1-&gt; fsm[i+1][1]</span><br>            fsm[i][<span class="hljs-number">0</span>]=de_s1(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">1</span>])<br>            flag=<span class="hljs-literal">True</span><br>        <span class="hljs-comment">#对于fsm[i][0]，只要知道其中任意三个值就可以推出剩下的一个值，所以顺带都写在这了</span><br>        __l=[<span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">1</span>]),<span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">2</span>]),<span class="hljs-built_in">type</span>(S[i+<span class="hljs-number">5</span>]),<span class="hljs-built_in">type</span>(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">0</span>])]<br>        <span class="hljs-keyword">if</span> __l.count(<span class="hljs-built_in">int</span>)==<span class="hljs-number">3</span>:<br>            flag=<span class="hljs-literal">True</span><br>            __=__l.index(<span class="hljs-built_in">str</span>)<br>            <span class="hljs-keyword">if</span> __==<span class="hljs-number">0</span>:<br>                fsm[i][<span class="hljs-number">1</span>]=(fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]-(fsm[i][<span class="hljs-number">2</span>]^S[i+<span class="hljs-number">5</span>]))%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">1</span>:<br>                fsm[i][<span class="hljs-number">2</span>]=((fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]-fsm[i][<span class="hljs-number">1</span>])^S[i+<span class="hljs-number">5</span>])%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">2</span>:<br>                S[i+<span class="hljs-number">5</span>]=((fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]-fsm[i][<span class="hljs-number">1</span>])^fsm[i][<span class="hljs-number">2</span>])%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">3</span>:<br>                fsm[i+<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]=(fsm[i][<span class="hljs-number">1</span>]+(fsm[i][<span class="hljs-number">2</span>]^S[i+<span class="hljs-number">5</span>]))%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>    <span class="hljs-keyword">return</span> flag<br><span class="hljs-comment">#检查clock_fsm里面的F的推导，只要知道其中任意三个值就可以推出剩下的一个值</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkFSFSM</span>():<br>    flag=<span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(S)-<span class="hljs-number">15</span>):<br>        __l=[<span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">0</span>]),<span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">1</span>]),<span class="hljs-built_in">type</span>(F[i]),<span class="hljs-built_in">type</span>(S[i+<span class="hljs-number">15</span>])]<br>        <span class="hljs-keyword">if</span> __l.count(<span class="hljs-built_in">int</span>)==<span class="hljs-number">3</span>:<br>            flag=<span class="hljs-literal">True</span><br>            __=__l.index(<span class="hljs-built_in">str</span>)<br>            <span class="hljs-keyword">if</span> __==<span class="hljs-number">0</span>:<br>                fsm[i][<span class="hljs-number">0</span>]=((F[i]^fsm[i][<span class="hljs-number">1</span>])-S[i+<span class="hljs-number">15</span>])%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">1</span>:<br>                fsm[i][<span class="hljs-number">1</span>]=(F[i]^(S[i+<span class="hljs-number">15</span>]+fsm[i][<span class="hljs-number">0</span>]))%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">2</span>:<br>                F[i]=((S[i+<span class="hljs-number">15</span>]+fsm[i][<span class="hljs-number">0</span>])^fsm[i][<span class="hljs-number">1</span>])%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">3</span>:<br>                S[i+<span class="hljs-number">15</span>]=((F[i]^fsm[i][<span class="hljs-number">1</span>])-fsm[i][<span class="hljs-number">0</span>])%<span class="hljs-number">2</span>**<span class="hljs-number">32</span><br>    <span class="hljs-keyword">return</span> flag<br><br><span class="hljs-comment">#检查F,S,key_stream的互相之间的推导，知道任意2个可以推出剩下的一个</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkFSSTREAM</span>():<br>    flag=<span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(key_stream)):<br>        __l=[<span class="hljs-built_in">type</span>(key_stream[i]),<span class="hljs-built_in">type</span>(F[i]),<span class="hljs-built_in">type</span>(S[i])]<br>        <span class="hljs-keyword">if</span> __l.count(<span class="hljs-built_in">int</span>)==<span class="hljs-number">2</span>:<br>            flag=<span class="hljs-literal">True</span><br>            __=__l.index(<span class="hljs-built_in">str</span>)<br>            <span class="hljs-keyword">if</span> __==<span class="hljs-number">0</span>:<br>                key_stream[i]=F[i]^S[i]<br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">1</span>:<br>                F[i]=key_stream[i]^S[i]<br>            <span class="hljs-keyword">elif</span> __==<span class="hljs-number">2</span>:<br>                S[i]=key_stream[i]^F[i]<br>    <span class="hljs-keyword">return</span> flag<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkALL</span>():<br>    flag=checkFSM()<br>    flag=flag <span class="hljs-keyword">or</span> checkFSFSM()<br>    flag=flag <span class="hljs-keyword">or</span> checkFSSTREAM()<br>    flag=flag <span class="hljs-keyword">or</span> checkS()<br>    <span class="hljs-comment">#checkCORRECT()</span><br>    <span class="hljs-keyword">return</span> flag<br><br>    <br><span class="hljs-comment">#测试用函数===================================================================================</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkCORRECT</span>():<br>    t_S=[<span class="hljs-number">3728967755</span>, <span class="hljs-number">3495356165</span>, <span class="hljs-number">472187142</span>, <span class="hljs-number">886943789</span>, <span class="hljs-number">4084678986</span>, <span class="hljs-number">114208514</span>, <span class="hljs-number">4079807976</span>, <span class="hljs-number">4275161248</span>, <span class="hljs-number">3282638664</span>, <span class="hljs-number">2076006597</span>, <span class="hljs-number">3373805671</span>, <span class="hljs-number">2974123815</span>, <span class="hljs-number">3847446102</span>, <span class="hljs-number">2029449241</span>, <span class="hljs-number">1167248190</span>, <span class="hljs-number">3124340476</span>, <span class="hljs-number">2413002776</span>, <span class="hljs-number">3447953474</span>, <span class="hljs-number">4266587847</span>, <span class="hljs-number">4175396429</span>, <span class="hljs-number">4131847277</span>, <span class="hljs-number">1684661431</span>, <span class="hljs-number">2541104664</span>, <span class="hljs-number">2037740470</span>, <span class="hljs-number">2396869767</span>, <span class="hljs-number">4221185578</span>, <span class="hljs-number">3017606363</span>, <span class="hljs-number">2068083020</span>, <span class="hljs-number">2267507878</span>, <span class="hljs-number">3591283476</span>, <span class="hljs-number">2686059627</span>, <span class="hljs-number">1351965579</span>, <span class="hljs-number">545189806</span>, <span class="hljs-number">3529654008</span>, <span class="hljs-number">795261281</span>, <span class="hljs-number">3336159413</span>, <span class="hljs-number">55920688</span>, <span class="hljs-number">3640778187</span>, <span class="hljs-number">10677684</span>, <span class="hljs-number">2992943598</span>, <span class="hljs-number">1690983591</span>, <span class="hljs-number">1929655536</span>, <span class="hljs-number">858855436</span>, <span class="hljs-number">3516290525</span>, <span class="hljs-number">208822826</span>, <span class="hljs-number">1790432759</span>, <span class="hljs-number">1090329888</span>, <span class="hljs-number">3311895372</span>, <span class="hljs-number">2442868764</span>, <span class="hljs-number">525297149</span>, <span class="hljs-number">1581426865</span>, <span class="hljs-number">2535702230</span>, <span class="hljs-number">3690055020</span>, <span class="hljs-number">2897748567</span>, <span class="hljs-number">1087734291</span>, <span class="hljs-number">2968696404</span>, <span class="hljs-number">790180987</span>, <span class="hljs-number">1067508412</span>, <span class="hljs-number">1812069970</span>]<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(t_S)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(S[i])==<span class="hljs-built_in">int</span>:<br>            <span class="hljs-keyword">if</span> S[i]!=t_S[i]:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;S:&#x27;</span>,i)<br>    t_r1=[<span class="hljs-number">4288109169</span>, <span class="hljs-number">566438029</span>, <span class="hljs-number">3252420959</span>, <span class="hljs-number">310114661</span>, <span class="hljs-number">405113667</span>, <span class="hljs-number">42168638</span>, <span class="hljs-number">426348252</span>, <span class="hljs-number">2217508059</span>, <span class="hljs-number">2364527128</span>, <span class="hljs-number">2513670487</span>, <span class="hljs-number">4258403922</span>, <span class="hljs-number">1344762431</span>, <span class="hljs-number">3259421801</span>, <span class="hljs-number">2290768410</span>, <span class="hljs-number">3562266277</span>, <span class="hljs-number">3034556817</span>, <span class="hljs-number">2874338847</span>, <span class="hljs-number">2207755823</span>, <span class="hljs-number">3434078908</span>, <span class="hljs-number">3673270886</span>, <span class="hljs-number">3634307680</span>, <span class="hljs-number">887505320</span>, <span class="hljs-number">3272180482</span>, <span class="hljs-number">3182178649</span>, <span class="hljs-number">2463707393</span>, <span class="hljs-number">3945361442</span>, <span class="hljs-number">532203740</span>, <span class="hljs-number">3515575884</span>, <span class="hljs-number">2670224373</span>, <span class="hljs-number">219742259</span>, <span class="hljs-number">3138161244</span>, <span class="hljs-number">1504798987</span>, <span class="hljs-number">3549858809</span>, <span class="hljs-number">1036509647</span>, <span class="hljs-number">2256657537</span>, <span class="hljs-number">4291048480</span>, <span class="hljs-number">3146309710</span>, <span class="hljs-number">1353304775</span>, <span class="hljs-number">3251573430</span>, <span class="hljs-number">278650815</span>, <span class="hljs-number">2240592460</span>, <span class="hljs-number">2202855101</span>, <span class="hljs-number">3645670807</span>, <span class="hljs-number">2183393958</span>, <span class="hljs-number">1051616755</span>, <span class="hljs-number">3920219094</span>, <span class="hljs-number">3655214575</span>, <span class="hljs-number">2766578751</span>, <span class="hljs-number">1372178632</span>, <span class="hljs-number">1819972070</span>, <span class="hljs-number">4032746236</span>, <span class="hljs-number">3996865332</span>, <span class="hljs-number">2470546560</span>, <span class="hljs-number">2521538742</span>, <span class="hljs-number">562444771</span>, <span class="hljs-number">2248808042</span>, <span class="hljs-number">3424030997</span>, <span class="hljs-number">638968787</span>, <span class="hljs-number">1996261738</span>, <span class="hljs-number">2006370108</span>]<br><br>    t_r2=[<span class="hljs-number">1355885794</span>, <span class="hljs-number">3828109594</span>, <span class="hljs-number">472496693</span>, <span class="hljs-number">1076682495</span>, <span class="hljs-number">3872837314</span>, <span class="hljs-number">1840614625</span>, <span class="hljs-number">1816901402</span>, <span class="hljs-number">3255922705</span>, <span class="hljs-number">262821239</span>, <span class="hljs-number">1309786686</span>, <span class="hljs-number">1583923810</span>, <span class="hljs-number">1523195432</span>, <span class="hljs-number">3041126837</span>, <span class="hljs-number">1214947918</span>, <span class="hljs-number">2931262268</span>, <span class="hljs-number">1778538638</span>, <span class="hljs-number">3573090404</span>, <span class="hljs-number">3075404417</span>, <span class="hljs-number">2429921657</span>, <span class="hljs-number">3637677643</span>, <span class="hljs-number">4131381119</span>, <span class="hljs-number">3779984047</span>, <span class="hljs-number">1617841815</span>, <span class="hljs-number">686529006</span>, <span class="hljs-number">3837496372</span>, <span class="hljs-number">3892378064</span>, <span class="hljs-number">2477993090</span>, <span class="hljs-number">2397911448</span>, <span class="hljs-number">2777576939</span>, <span class="hljs-number">1392741422</span>, <span class="hljs-number">1550955835</span>, <span class="hljs-number">2448835842</span>, <span class="hljs-number">3240053317</span>, <span class="hljs-number">3509923480</span>, <span class="hljs-number">4119599101</span>, <span class="hljs-number">375278529</span>, <span class="hljs-number">3937252695</span>, <span class="hljs-number">2608352072</span>, <span class="hljs-number">1358566283</span>, <span class="hljs-number">1627404846</span>, <span class="hljs-number">503044471</span>, <span class="hljs-number">3736592806</span>, <span class="hljs-number">3934907064</span>, <span class="hljs-number">1460859829</span>, <span class="hljs-number">3855897853</span>, <span class="hljs-number">3244167835</span>, <span class="hljs-number">4051089435</span>, <span class="hljs-number">847623116</span>, <span class="hljs-number">3403687926</span>, <span class="hljs-number">2949222116</span>, <span class="hljs-number">1917891093</span>, <span class="hljs-number">624600427</span>, <span class="hljs-number">2001915094</span>, <span class="hljs-number">147539826</span>, <span class="hljs-number">3128478596</span>, <span class="hljs-number">2224489645</span>, <span class="hljs-number">2923913710</span>, <span class="hljs-number">3146498598</span>, <span class="hljs-number">398940241</span>, <span class="hljs-number">1637262462</span>]<br><br>    t_r3=[<span class="hljs-number">3594474665</span>, <span class="hljs-number">780361133</span>, <span class="hljs-number">142866320</span>, <span class="hljs-number">340900620</span>, <span class="hljs-number">1611791033</span>, <span class="hljs-number">1655452060</span>, <span class="hljs-number">2795848422</span>, <span class="hljs-number">797785169</span>, <span class="hljs-number">4276079609</span>, <span class="hljs-number">3931283242</span>, <span class="hljs-number">1267140897</span>, <span class="hljs-number">3903796825</span>, <span class="hljs-number">516286503</span>, <span class="hljs-number">1973930640</span>, <span class="hljs-number">4277622808</span>, <span class="hljs-number">3071699452</span>, <span class="hljs-number">3405201788</span>, <span class="hljs-number">2182536739</span>, <span class="hljs-number">862548827</span>, <span class="hljs-number">1896988818</span>, <span class="hljs-number">3309063171</span>, <span class="hljs-number">1382452360</span>, <span class="hljs-number">645501838</span>, <span class="hljs-number">4006280117</span>, <span class="hljs-number">3496165626</span>, <span class="hljs-number">2544749415</span>, <span class="hljs-number">1833769537</span>, <span class="hljs-number">809879027</span>, <span class="hljs-number">3051926704</span>, <span class="hljs-number">1198409551</span>, <span class="hljs-number">1004958565</span>, <span class="hljs-number">1123356359</span>, <span class="hljs-number">2779335233</span>, <span class="hljs-number">3052290141</span>, <span class="hljs-number">3093081549</span>, <span class="hljs-number">3252733994</span>, <span class="hljs-number">385360256</span>, <span class="hljs-number">359128930</span>, <span class="hljs-number">1849137641</span>, <span class="hljs-number">687792692</span>, <span class="hljs-number">266786993</span>, <span class="hljs-number">3127492305</span>, <span class="hljs-number">1392346274</span>, <span class="hljs-number">1979730466</span>, <span class="hljs-number">479859492</span>, <span class="hljs-number">1187167205</span>, <span class="hljs-number">608981746</span>, <span class="hljs-number">3300250000</span>, <span class="hljs-number">220351399</span>, <span class="hljs-number">4245003</span>, <span class="hljs-number">3407353675</span>, <span class="hljs-number">1092604782</span>, <span class="hljs-number">559427932</span>, <span class="hljs-number">1958415395</span>, <span class="hljs-number">2773555934</span>, <span class="hljs-number">1261361337</span>, <span class="hljs-number">1619553922</span>, <span class="hljs-number">3312946173</span>, <span class="hljs-number">3589284217</span>, <span class="hljs-number">4259352522</span>]<br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(t_r1)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">0</span>])==<span class="hljs-built_in">int</span> <span class="hljs-keyword">and</span> fsm[i][<span class="hljs-number">0</span>]!=t_r1[i]:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;R1:&#x27;</span>,i,<span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">1</span>])==<span class="hljs-built_in">int</span> <span class="hljs-keyword">and</span> fsm[i][<span class="hljs-number">1</span>]!=t_r2[i]:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;R2:&#x27;</span>,i,<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(fsm[i][<span class="hljs-number">2</span>])==<span class="hljs-built_in">int</span> <span class="hljs-keyword">and</span> fsm[i][<span class="hljs-number">2</span>]!=t_r3[i]:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;R3:&#x27;</span>,i,<span class="hljs-number">2</span>)<br>    t_F=[<span class="hljs-number">3909102991</span>, <span class="hljs-number">1438316991</span>, <span class="hljs-number">2473993108</span>, <span class="hljs-number">1357262547</span>, <span class="hljs-number">4157851474</span>, <span class="hljs-number">2508185930</span>, <span class="hljs-number">295224457</span>, <span class="hljs-number">3652442850</span>, <span class="hljs-number">164565177</span>, <span class="hljs-number">1788946400</span>, <span class="hljs-number">2802091550</span>, <span class="hljs-number">1590585650</span>, <span class="hljs-number">2294852608</span>, <span class="hljs-number">1205560462</span>, <span class="hljs-number">81068677</span>, <span class="hljs-number">1056699762</span>, <span class="hljs-number">789660110</span>, <span class="hljs-number">324562780</span>, <span class="hljs-number">264734925</span>, <span class="hljs-number">3532320140</span>, <span class="hljs-number">1766276202</span>, <span class="hljs-number">3648418679</span>, <span class="hljs-number">4234489434</span>, <span class="hljs-number">2527364835</span>, <span class="hljs-number">2709941979</span>, <span class="hljs-number">2817733913</span>, <span class="hljs-number">17813838</span>, <span class="hljs-number">2320613312</span>, <span class="hljs-number">3576745017</span>, <span class="hljs-number">1250487923</span>, <span class="hljs-number">2041959784</span>, <span class="hljs-number">190366505</span>, <span class="hljs-number">1507935488</span>, <span class="hljs-number">508966771</span>, <span class="hljs-number">1348294019</span>, <span class="hljs-number">1213765392</span>, <span class="hljs-number">3087084147</span>, <span class="hljs-number">3085163387</span>, <span class="hljs-number">1048389254</span>, <span class="hljs-number">812735484</span>, <span class="hljs-number">730114519</span>, <span class="hljs-number">1825700510</span>, <span class="hljs-number">4066673387</span>, <span class="hljs-number">3107390285</span>, <span class="hljs-number">1220207318</span>, <span class="hljs-number">883241532</span>, <span class="hljs-number">5483853</span>, <span class="hljs-number">275268404</span>, <span class="hljs-number">384384940</span>, <span class="hljs-number">2648392877</span>, <span class="hljs-number">2643780042</span>, <span class="hljs-number">2388170262</span>, <span class="hljs-number">704314697</span>, <span class="hljs-number">1113445259</span>, <span class="hljs-number">3645689675</span>, <span class="hljs-number">4150313002</span>, <span class="hljs-number">1649850319</span>, <span class="hljs-number">77719709</span>, <span class="hljs-number">1803356974</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(t_F)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span>(F[i])==<span class="hljs-built_in">int</span> <span class="hljs-keyword">and</span> F[i]!=t_F[i]:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;F:&#x27;</span>,i)<br><span class="hljs-comment">#测试用函数===================================================================================</span><br><br><br>key_stream=[<span class="hljs-string">&#x27;&#x27;</span>]*<span class="hljs-number">150</span><br>gift=<span class="hljs-string">b&quot;the quick brown fox jumps over the lazy dog\n&quot;</span><br>C=[<span class="hljs-number">3539094009</span>, <span class="hljs-number">980211684</span>, <span class="hljs-number">2198891016</span>, <span class="hljs-number">905998740</span>, <span class="hljs-number">1595475160</span>, <span class="hljs-number">3962636204</span>, <span class="hljs-number">1199994505</span>, <span class="hljs-number">3190370623</span>, <span class="hljs-number">296595869</span>, <span class="hljs-number">3158272345</span>, <span class="hljs-number">2748985736</span>, <span class="hljs-number">382671580</span>, <span class="hljs-number">2521428409</span>, <span class="hljs-number">248078233</span>, <span class="hljs-number">1528783547</span>, <span class="hljs-number">2729100548</span>, <span class="hljs-number">3426466722</span>, <span class="hljs-number">3192873770</span>, <span class="hljs-number">1337295957</span>, <span class="hljs-number">1431041587</span>, <span class="hljs-number">1607853207</span>, <span class="hljs-number">3998694569</span>, <span class="hljs-number">3160389002</span>, <span class="hljs-number">3728077354</span>, <span class="hljs-number">1120982789</span>, <span class="hljs-number">3443900372</span>, <span class="hljs-number">1811224296</span>, <span class="hljs-number">3102761228</span>, <span class="hljs-number">3296566547</span>, <span class="hljs-number">3724398326</span>, <span class="hljs-number">873334127</span>, <span class="hljs-number">3279785283</span>, <span class="hljs-number">1267844209</span>, <span class="hljs-number">907638672</span>, <span class="hljs-number">2121413959</span>, <span class="hljs-number">3173567371</span>, <span class="hljs-number">4097722407</span>, <span class="hljs-number">844863077</span>, <span class="hljs-number">3114817962</span>, <span class="hljs-number">3619759560</span>, <span class="hljs-number">2198708209</span>, <span class="hljs-number">2363435526</span>, <span class="hljs-number">196774438</span>, <span class="hljs-number">2671749579</span>, <span class="hljs-number">4031688923</span>, <span class="hljs-number">471349633</span>, <span class="hljs-number">778676959</span>, <span class="hljs-number">3608967403</span>, <span class="hljs-number">92491149</span>, <span class="hljs-number">913291948</span>, <span class="hljs-number">3021362116</span>, <span class="hljs-number">1067932129</span>, <span class="hljs-number">999259588</span>, <span class="hljs-number">3190588842</span>, <span class="hljs-number">1828097126</span>, <span class="hljs-number">1450255462</span>, <span class="hljs-number">1305572961</span>, <span class="hljs-number">1341694028</span>, <span class="hljs-number">2350778224</span>, <span class="hljs-number">2932388574</span>, <span class="hljs-number">1204050979</span>, <span class="hljs-number">1294999174</span>, <span class="hljs-number">1921124090</span>, <span class="hljs-number">2342994011</span>, <span class="hljs-number">1941020673</span>, <span class="hljs-number">1191919176</span>, <span class="hljs-number">187588176</span>, <span class="hljs-number">255691701</span>, <span class="hljs-number">274795123</span>, <span class="hljs-number">873091533</span>, <span class="hljs-number">299848364</span>, <span class="hljs-number">870697920</span>, <span class="hljs-number">3387594780</span>, <span class="hljs-number">944072831</span>, <span class="hljs-number">848477078</span>, <span class="hljs-number">447469593</span>, <span class="hljs-number">917439649</span>, <span class="hljs-number">598555627</span>, <span class="hljs-number">3036173079</span>, <span class="hljs-number">3758185777</span>, <span class="hljs-number">4236584984</span>, <span class="hljs-number">4205933999</span>, <span class="hljs-number">1185586113</span>, <span class="hljs-number">3227810954</span>, <span class="hljs-number">2737102694</span>, <span class="hljs-number">3680871868</span>, <span class="hljs-number">4102277292</span>, <span class="hljs-number">378037705</span>]<br><br>hack=[<span class="hljs-number">834501734</span>,<span class="hljs-number">940247165</span>,<span class="hljs-number">2078728259</span>,<span class="hljs-number">483907438</span>,<span class="hljs-number">1102712410</span>,<span class="hljs-number">3110955761</span>,<span class="hljs-number">3016462560</span>,<span class="hljs-number">871310805</span>,<span class="hljs-number">1334672645</span>,<span class="hljs-number">1102778698</span>]<br><br><br>fsm=[[<span class="hljs-string">&#x27;&#x27;</span>]*<span class="hljs-number">3</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">150</span>)]<br>S=[<span class="hljs-string">&#x27;&#x27;</span>]*<span class="hljs-number">150</span><br>F=[<span class="hljs-string">&#x27;&#x27;</span>]*<span class="hljs-number">150</span><br><br><span class="hljs-comment">#填一下已知数据</span><br>fsm[<span class="hljs-number">2</span>][<span class="hljs-number">0</span>]=hack[<span class="hljs-number">0</span>]<br>fsm[<span class="hljs-number">2</span>][<span class="hljs-number">1</span>]=hack[<span class="hljs-number">1</span>]<br>fsm[<span class="hljs-number">2</span>][<span class="hljs-number">2</span>]=hack[<span class="hljs-number">2</span>]<br>S[<span class="hljs-number">2</span>]=hack[<span class="hljs-number">3</span>]<br>S[<span class="hljs-number">3</span>]=hack[<span class="hljs-number">4</span>]<br>S[<span class="hljs-number">6</span>]=hack[<span class="hljs-number">5</span>]<br>S[<span class="hljs-number">7</span>]=hack[<span class="hljs-number">6</span>]<br>S[<span class="hljs-number">8</span>]=hack[<span class="hljs-number">7</span>]<br>fsm[<span class="hljs-number">5</span>][<span class="hljs-number">0</span>]=hack[<span class="hljs-number">8</span>]<br>fsm[<span class="hljs-number">7</span>][<span class="hljs-number">0</span>]=hack[<span class="hljs-number">9</span>]<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(gift)):<br>    key_stream[i]=C[i]^gift[i]<br><br>F[<span class="hljs-number">2</span>]=S[<span class="hljs-number">2</span>]^key_stream[<span class="hljs-number">2</span>]<br>F[<span class="hljs-number">3</span>]=S[<span class="hljs-number">3</span>]^key_stream[<span class="hljs-number">3</span>]<br>F[<span class="hljs-number">6</span>]=S[<span class="hljs-number">6</span>]^key_stream[<span class="hljs-number">6</span>]<br>F[<span class="hljs-number">7</span>]=S[<span class="hljs-number">7</span>]^key_stream[<span class="hljs-number">7</span>]<br>F[<span class="hljs-number">8</span>]=S[<span class="hljs-number">8</span>]^key_stream[<span class="hljs-number">8</span>]<br><br><span class="hljs-keyword">while</span> checkALL():<br>    <span class="hljs-literal">None</span><br><br>plain=<span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(C)):<br>    plain+=long_to_bytes(key_stream[i]^C[i])<br><span class="hljs-built_in">print</span>(plain)<br></code></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs result">b&#x27;the quick brown fox jumps over the lazy dog\nDASCTF&#123;2bfc1bd3-740e-4b3f-ab9f-9587b1d47209&#125;&#x27;<br></code></pre></td></tr></table></figure>

<p>那么预赛也是全复现完了，我是没找到预赛的密码的wp，那么就这样吧。<br>发现我的de_lfsr_keystream_mode的错误了请和我说一下哦。<br><img src="/2025/02/01/2024%E6%B5%99%E6%B1%9F%E7%9C%81%E8%B5%9B/1.jpg" srcset="/img/loading.gif" lazyload></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/crypto/" class="category-chain-item">crypto</a>
  
  
    <span>></span>
    
  <a href="/categories/crypto/DASCTF/" class="category-chain-item">DASCTF</a>
  
  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/crypto/" class="print-no-link">#crypto</a>
      
        <a href="/tags/RSA/" class="print-no-link">#RSA</a>
      
        <a href="/tags/DASCTF/" class="print-no-link">#DASCTF</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>2024浙江省赛</div>
      <div>https://bddye.github.io/2025/02/01/2024浙江省赛/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>蹦跶的鱼儿</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年2月1日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/02/01/crypto%E7%9A%84%E5%B0%8F%E6%B1%A0%E5%A1%98/" title="crypto的小池塘">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">crypto的小池塘</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/01/22/2025.1.18DASCTF/" title="2025.1.18 DASCTF">
                        <span class="hidden-mobile">2025.1.18 DASCTF</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
