<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>2025.1.18 DASCTF</title>
    <link href="/2025/01/22/2025.1.18DASCTF/"/>
    <url>/2025/01/22/2025.1.18DASCTF/</url>
    
    <content type="html"><![CDATA[<h1 id="2025-1-18è¥¿æ¹–è®ºå‰‘"><a href="#2025-1-18è¥¿æ¹–è®ºå‰‘" class="headerlink" title="2025.1.18è¥¿æ¹–è®ºå‰‘"></a>2025.1.18è¥¿æ¹–è®ºå‰‘</h1><p>æ˜¯ <strong>2025.1.18è¥¿æ¹–è®ºå‰‘</strong> å“’ï¼</p><h2 id="matrixRSA"><a href="#matrixRSA" class="headerlink" title="matrixRSA"></a>matrixRSA</h2><p>å…ˆçœ‹é¢˜ç›®</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> flag<br>ext_len = <span class="hljs-number">9</span>*<span class="hljs-number">23</span> - <span class="hljs-built_in">len</span>(flag)<br>flag += <span class="hljs-string">&#x27;&#x27;</span>.join(random.choice(string.printable) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(ext_len))<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">my_rsa_encrypt</span>():<br>    p = getPrime(<span class="hljs-number">512</span>)<br>    q = getPrime(<span class="hljs-number">512</span>)<br>    n = p * q<br>    data = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>        data.append(bytes_to_long(flag[<span class="hljs-number">23</span>*i:<span class="hljs-number">23</span>*(i+<span class="hljs-number">1</span>)].encode()))<br>    M = Matrix(Zmod(n), [data[i:i+<span class="hljs-number">3</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(data), <span class="hljs-number">3</span>)])<br>    e = <span class="hljs-number">65537</span><br>    C = M**e<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;p =&quot;</span>, p &gt;&gt; <span class="hljs-number">100</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;n =&quot;</span>, n)<br>    <span class="hljs-keyword">return</span> C<br>C = my_rsa_encrypt()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;C =&quot;</span>, C)<br></code></pre></td></tr></table></figure><p>é¢˜ç›®å°†çŸ©é˜µç”¨RSAçš„æ–¹å¼è¿›è¡Œäº†åŠ å¯†<br>ç„¶åç»™å‡ºäº†pçš„é«˜412ä½,n,å’ŒC</p><p>ç›´æ¥ä¸Šcoppersmithå³å¯è§£å‡ºp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sage">p=9707529668721508094878754383636813058761407528950189013789315732447048631740849315894253576415843631107370002912949379757275<br>n=132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009<br>p=p&lt;&lt;100<br>bit=100<br>R.&lt;x&gt;=PolynomialRing(Zmod(n))<br>f=p+x<br>f=f.monic()<br>roots=f.small_roots(X=2^bit,beta=0.4,epsilon=0.01)<br>print(roots)<br></code></pre></td></tr></table></figure><blockquote><p>[386875690473242360543194849663]</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">p=<span class="hljs-number">12305755811288164655681709252717258015229295989302934566212712319314835335461946241491177972870130171728224502716603340551354171940107285908105124549960063</span><br>q=<span class="hljs-number">10750967246621849802090386055921679114516122704252330881722100331526757637044067492444912824266860574267360247681890637480406758188129451052986858429875143</span><br></code></pre></td></tr></table></figure><p>åˆšå¼€å§‹å…ˆè¯•è¯•phi&#x3D;(p-1)*(q-1)<br>æŒ‰æ­£å¸¸RSAæ¥è§£å‘ç°ç»“æœä¸å¯¹<br>ä¸Šç½‘æœç´¢ï¼ˆæœç´¢å¼•æ“yydsï¼‰<br>å‘ç°è¿™é“é¢˜å…¶å®æ˜¯è®ºæ–‡å¤ç°<br>åŸºæœ¬æ˜¯åŸé¢˜äº†ï¼Œ<a href="https://latallvia-d.github.io/2024/07/02/%E8%AE%BA%E6%96%87%E5%A4%8D%E7%8E%B0%EF%BC%9AA%20Matrix%20Extension%20of%20the%20RSA%20Cryptosystem/">è¿™æ˜¯åŸæ–‡</a> <del>ä»–åšå®¢ä¸»é¢˜æ€ä¹ˆè·Ÿæˆ‘ä¸€æ ·ï¼ˆå°å£°ï¼‰</del></p><p><img src="/2025/01/22/2025.1.18DASCTF/1.png"><br>é‚£ä¹ˆæŠŠphiç”¨(p**2-1)*(p**2-p)*(q**2-1)*(q**2-q)ä»£æ‰å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>C = [[<span class="hljs-number">130700952989014311434434028098810412089294728270156705618326733322297465714495704072159530618655340096705383710304658044991149662060657745933090473082775425812641300964472543605460360640675949447837208449794830578184968528547366608180085787382376536622136035364815331037493098283462540849880674541138443271941</span>,<span class="hljs-number">71108771421281691064141020659106224750236412635914570166893031318860027728093402453305986361330527563506168063047627979831630830003190075818824767924892107148560048725155587353683119195901991465464478196049173060097561821877061015587704803006499153902855903286456023726638247758665778434728734461065079337757</span>,<span class="hljs-number">67999998657112350704927993584783146575182096185020115836188544590466205688442741039622382576899587857972463337900200038021257164640987281308471100297698062626107380871262596623736773815445544153508352926374272336154553916204320257697068627063236060520725376727528604938949588845448940836430120015498687885615</span>],<br>[ <span class="hljs-number">23893343854815011808020457237095285782125931083991537368666368653089096539223297567339111502968295914745423286070638369517207554770793304994639155083818859208362057394004419565231389473766857235749279110546079776040193183912062870294579472815588333047561915280189529367474392709554971446978468118280633281993</span>,<span class="hljs-number">9711323829269829751519177755915164402658693668631868499383945203627197171508441332211907278473276713066275283973856513580205808517918096017699122954464305556795300874005627001464297760413897074044080665941802588680926430030715299713241442313300920463145903399054123967914968894345491958980945927764454159601</span>,<span class="hljs-number">44904507975955275578858125671789564568591470104141872573541481508697254621798834910263012676346204850278744732796211742615531019931085695420000582627144871996018850098958417750918177991375489106531511894991744745328626887250694950153424439172667977623425955725695498585224383607063387876414273539268016177401</span>],<br>[ <span class="hljs-number">67805732998935098446255672500407441801838056284635701147853683333480924477835278030145327818330916280792499177503535618310624546400536573924729837478349680007368781306805363621196573313903080315513952415535369016620873765493531188596985587834408434835281527678166509365418905214174034794683785063802543354572</span>,<span class="hljs-number">13486048723056269216825615499052563411132892702727634833280269923882908676944418624902325737619945647093190397919828623788245644333036340084254490542292357044974139884304715033710988658109160936809398722070125690919829906642273377982021120160702344103998315875166038849942426382506293976662337161520494820727</span>,<span class="hljs-number">95932690738697024519546289135992512776877884741458439242887603021792409575448192508456813215486904392440772808083658410285088451086298418303987628634150431725794904656250453314950126433260613949819432633322599879072805834951478466009343397728711205498602927752917834774516505262381463414617797291857077444676</span>]]<br><br>n=<span class="hljs-number">132298777672085547096511087266255066285502135020124093900452138262993155381766816424955849796168059204379325075568094431259877923353664926875986223020472585645919414821322880213299188157427622804140996898685564075484754918339670099806186873974594139182324884620018780943630196754736972805036038798946726414009</span><br>p=<span class="hljs-number">12305755811288164655681709252717258015229295989302934566212712319314835335461946241491177972870130171728224502716603340551354171940107285908105124549960063</span><br>q=<span class="hljs-number">10750967246621849802090386055921679114516122704252330881722100331526757637044067492444912824266860574267360247681890637480406758188129451052986858429875143</span><br>e=<span class="hljs-number">65537</span><br>phi=(p**<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)*(p**<span class="hljs-number">2</span>-p)*(q**<span class="hljs-number">2</span>-<span class="hljs-number">1</span>)*(q**<span class="hljs-number">2</span>-q)<br>d=inverse(e,phi)<br>B=Matrix(Zmod(n),C)<br>B=B**d<br>flag=<span class="hljs-string">b&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):<br>        flag+=long_to_bytes(<span class="hljs-built_in">int</span>(B[i][j]))<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><p>æœ€åå¾—å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-string">b&#x27;DASCTF&#123;48ccbfd88061d7ff3d5325148ec55d11&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="å·²æ‚Ÿ"><a href="#å·²æ‚Ÿ" class="headerlink" title="å·²æ‚Ÿ"></a>å·²æ‚Ÿ</h2><p>é¢˜ç›®ç»™äº†ä¸¤ä¸ªpyæ–‡ä»¶</p><p>task:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> line_profiler <span class="hljs-keyword">import</span> LineProfiler<br><span class="hljs-keyword">from</span> secret <span class="hljs-keyword">import</span> get_key<br><span class="hljs-keyword">from</span> license <span class="hljs-keyword">import</span> RicKV<br><span class="hljs-keyword">import</span> os<br><br>flag = os.getenv(<span class="hljs-string">&#x27;DASFLAG&#x27;</span>)<br>smoke_key = get_key() <span class="hljs-comment"># the key just printable, this function is to make all users key different</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">login</span>(<span class="hljs-params">password</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(password) != <span class="hljs-built_in">len</span>(smoke_key):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(password)):<br>        <span class="hljs-keyword">if</span> password[i] != smoke_key[i]:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_password</span>(<span class="hljs-params">user_input,pro=<span class="hljs-literal">False</span></span>):<br>    profiler = LineProfiler()<br>    profiler.add_function(login)<br>    profiler.enable_by_count()<br>    is_valid = login(user_input)<br>    profiler.disable_by_count()<br>    x = profiler.get_stats().timings<br>    hacker,hacker_pro = [],[]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> x:<br>         <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> x[i]:<br>              hacker.append((j[<span class="hljs-number">0</span>],j[-<span class="hljs-number">1</span>]))<br>              hacker_pro.append(j)<br>    <span class="hljs-built_in">print</span>(hacker)<br>    <span class="hljs-keyword">return</span> is_valid, hacker_pro <span class="hljs-keyword">if</span> pro <span class="hljs-keyword">else</span> hacker<br><br>banner = <span class="hljs-string">&quot;ğŸï¸ âš”ï¸ 2ï¸âƒ£ 0ï¸âƒ£ 2ï¸âƒ£ 5ï¸âƒ£ ğŸ‘‹ ğŸ˜Š&quot;</span><br><br>MEUN = <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">1ï¸âƒ£ âœ¨ ğŸ”‘ ğŸš©</span><br><span class="hljs-string">2ï¸âƒ£ âœ¨ ğŸ›ï¸ âš¡ï¸ğŸ’¨5ï¸âƒ£</span><br><span class="hljs-string">3ï¸âƒ£ âœ¨ â¡ï¸ ğŸğŸ¬</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-built_in">print</span>(banner)<br>    pro = <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            <span class="hljs-built_in">print</span>(MEUN)<br>            choice = <span class="hljs-built_in">int</span>(<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;&gt; &quot;</span>)[<span class="hljs-number">0</span>])<br>            <span class="hljs-keyword">if</span> choice == <span class="hljs-number">3</span>:<br>                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸ”ï¸ğŸ‘â„ï¸ğŸ†ğŸ¦¦ğŸ¦ŠğŸ¹ğŸ‘©ğŸ”ï¸&quot;</span>)<br>                exit(<span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">elif</span> choice == <span class="hljs-number">1</span>:<br>                 password = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;ğŸ”‘ &gt; &quot;</span>).strip()<br>                 success,X = check_password(password,pro)<br>                 <span class="hljs-keyword">if</span> success:<br>                      <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;1ï¸âƒ£ â—5ï¸âƒ£ â—ğŸ‘´ğŸ’¨âš¡ï¸ğŸ’¨5ï¸âƒ£&quot;</span>)<br>                      <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ğŸš© <span class="hljs-subst">&#123;flag&#125;</span>&quot;</span>)<br>                      exit(<span class="hljs-number">0</span>)<br>                 <span class="hljs-keyword">else</span>:<br>                      <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;ğŸ¤” ğŸ’¨ <span class="hljs-subst">&#123;X&#125;</span> ğŸ’¨&quot;</span>)<br>            <span class="hljs-keyword">elif</span> choice == <span class="hljs-number">2</span>:<br>                 <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string"></span><br><span class="hljs-string">                 æ€ä¹ˆè·å–ç§˜é’¥ï¼Ÿ</span><br><span class="hljs-string"></span><br><span class="hljs-string">                 æ‚¨å¯ä»¥ä½¿ç”¨ CTF çš„ä¸€æŠŠæ¢­å·¥å…·,æˆ–è€…ç»™æˆ‘ä¸€æ”¯é”å…‹ã€‚</span><br><span class="hljs-string">                 Maybe you noob ctfer can go to xianyu or ask friend for help.</span><br><span class="hljs-string">                 ã–ã£ã“ã®æ–¹ã¯ã€xianyu ã«è¡Œãã‹ã€å‹é”ã«åŠ©ã‘ã‚’æ±‚ã‚ã‚‹ã¨ã„ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã–ã£ã“ï¼ã–ã£ã“ï¼ğŸ¤­ğŸ¤­ğŸ¤­</span><br><span class="hljs-string">                 à½˜à½‘à½¼à½‚à¼‹à½ à½‘à½¼à½‘à¼‹à½ à½‘à½²à¼‹ CTF à½‚à½“à½¼à½‘à¼‹à½”à½ à½²à¼‹à½£à½‚à¼‹à½†à½¼à½‘à¼‹à½£à½¦à¼‹ à½§à½²à½“à¼‹à½¨à½²à½ à½´à¼‹à½¡à½²à½“à¼‹à½£à½´à½„à¼‹ à½ à½¼à½‚à¼‹à½£à½´à¼‹à½£à½¼à½„à½¦à¼‹à½¦à¾à½‘à¼‹à½à½´à½„à½¦à¼‹à½£à½´à¼‹à½ à½›à½´à½£à¼‹à½–à¼‹à½ à½‘à½²à¼‹à½ à½‘à½¼à½‘à¼‹à½˜à½²à¼‹à½ à½–à½‘à¼‹à½¡à½¼à½‘à¼‹à½˜à½²à¼‹à½ à½‘à½´à½‚à¼‹ã€‚</span><br><span class="hljs-string"></span><br><span class="hljs-string">                 &quot;&quot;&quot;</span><br>                 license_key = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;ğŸ”‘ &gt; &quot;</span>).strip()<br>                 license = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;ğŸ“œ &gt; &quot;</span>).strip()<br>                 rick = RicKV(license_key)<br>                 <span class="hljs-keyword">if</span> rick.check(license):<br>                      pro = <span class="hljs-literal">True</span><br>                 <span class="hljs-keyword">else</span>:<br>                      <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;ğŸ‘µğŸ»ğŸ‘µğŸ»ğŸ¤°ğŸ‘¶&quot;</span>)<br></code></pre></td></tr></table></figure><p>license:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> functools <span class="hljs-keyword">import</span> reduce<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> hashlib<br><br>Xor= <span class="hljs-keyword">lambda</span> v: reduce(<span class="hljs-keyword">lambda</span> res, x: res ^ x, v, <span class="hljs-number">0</span>)<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">RicKV</span>:<br>    <span class="hljs-built_in">round</span> = <span class="hljs-number">15</span><br>    S1 = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br>    S2 = [i <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, key</span>):<br>        key = hashlib.sha256(<span class="hljs-built_in">str</span>(key).encode(<span class="hljs-string">&quot;utf-8&quot;</span>)).digest()<br>        random.seed(key)<br>        <span class="hljs-variable language_">self</span>.roundkey = <span class="hljs-built_in">int</span>(key.<span class="hljs-built_in">hex</span>(), <span class="hljs-number">16</span>)<br>        <span class="hljs-variable language_">self</span>.subkeys = [<br>            [<br>                ((<span class="hljs-built_in">int</span>(<span class="hljs-built_in">bin</span>(<span class="hljs-variable language_">self</span>.roundkey)[<span class="hljs-number">2</span>:].zfill(<span class="hljs-number">16</span> * (<span class="hljs-variable language_">self</span>.<span class="hljs-built_in">round</span>+ <span class="hljs-number">1</span>))[<span class="hljs-number">16</span> * j + i]) &amp; <span class="hljs-number">1</span>) - <span class="hljs-number">1</span>) &amp; <span class="hljs-number">0xf</span><br>                <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)<br>            ]<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.<span class="hljs-built_in">round</span> + <span class="hljs-number">1</span>)<br>        ]<br>        random.shuffle(<span class="hljs-variable language_">self</span>.S1)<br>        random.shuffle(<span class="hljs-variable language_">self</span>.S2)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_round</span>(<span class="hljs-params">self, s, k</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>):<br>                s[i*<span class="hljs-number">4</span>+j] ^= k[i]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">sub</span>(<span class="hljs-params">self,s</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            index = <span class="hljs-variable language_">self</span>.S2[i]  <br>            temp = s[index]     <br>            s[i] = <span class="hljs-variable language_">self</span>.S1[temp]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mix_1</span>(<span class="hljs-params">self,s,r</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>            s[i] = s[i] ^ <span class="hljs-variable language_">self</span>.subkeys[i][r]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">mix_2</span>(<span class="hljs-params">self,s,x</span>):<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">16</span>,<span class="hljs-number">4</span>):<br>            x[i//<span class="hljs-number">4</span>] = Xor(s[i:i + <span class="hljs-number">4</span>])<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">flip</span>(<span class="hljs-params">self, plaintext</span>):<br>        <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(plaintext) == <span class="hljs-number">8</span><br>        S = [<span class="hljs-built_in">int</span>(_, <span class="hljs-number">16</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">list</span>(plaintext.<span class="hljs-built_in">hex</span>())]<br>        X = [<span class="hljs-number">0</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">4</span>)]<br>        <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.<span class="hljs-built_in">round</span>):<br>            <span class="hljs-variable language_">self</span>.mix_1(S,r)<br>            <span class="hljs-variable language_">self</span>.sub(S)<br>            <span class="hljs-variable language_">self</span>.mix_2(S,X)<br>            <span class="hljs-variable language_">self</span>.add_round(S,X)<br><br>        S = [S[i] ^ <span class="hljs-variable language_">self</span>.subkeys[<span class="hljs-variable language_">self</span>.<span class="hljs-built_in">round</span>][i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>)]<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;&quot;</span>.join(<span class="hljs-string">&quot;&#123;:x&#125;&quot;</span>.<span class="hljs-built_in">format</span>(_) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> S))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">check</span>(<span class="hljs-params">self,liscense</span>):<br>        liscense= base64.b64decode(liscense)<br>        <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(liscense) % <span class="hljs-number">8</span> == <span class="hljs-number">0</span><br>        l = <span class="hljs-string">b&quot;\x00&quot;</span> * <span class="hljs-number">8</span>  <br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(liscense),<span class="hljs-number">8</span>):<br>            l = <span class="hljs-built_in">bytes</span>(d^j <span class="hljs-keyword">for</span> d,j <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(l,liscense[i:i+<span class="hljs-number">8</span>]))<br>            l = <span class="hljs-variable language_">self</span>.flip(l)<br>            l = <span class="hljs-built_in">bytes</span>(d^j <span class="hljs-keyword">for</span> d,j <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(l,liscense[i:i+<span class="hljs-number">8</span>]))<br>        <span class="hljs-built_in">print</span>(l)<br>        <span class="hljs-keyword">return</span>  <span class="hljs-keyword">not</span> <span class="hljs-built_in">any</span>(l)<br></code></pre></td></tr></table></figure><p>å…ˆçœ‹task<br>loginå‡½æ•°åˆ¤æ–­è¾“å…¥æ˜¯å¦ä¸smkoe_keyç›¸åŒï¼Œä¸åŒåˆ™ç«‹åˆ»è¿”å›False<br>check_passwordè°ƒç”¨loginå¹¶è¿”å›loginæ‰§è¡Œçš„ç»†èŠ‚ï¼ŒåŒ…æ‹¬æ‰§è¡Œäº†å“ªä¸€è¡Œï¼Œæ‰§è¡Œæ¬¡æ•°ï¼Œæ‰§è¡Œæ—¶é—´<br>ä½†å¦‚æœproæ˜¯Falseï¼Œæˆ‘ä»¬æ˜¯æ‹¿ä¸åˆ°æ‰§è¡Œæ¬¡æ•°çš„<br>licenseåˆ™æ˜¯å¯¹è¾“å…¥è¿›è¡Œä¸€ä¸ªåˆ¤æ–­</p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨2ä¸­æåŠä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„licenseï¼Œç„¶åå°±å¯ä»¥å¼€å§‹é’ˆå¯¹æ‰§è¡Œæ¬¡æ•°æ”»å‡»<br>åœ¨licenseä¸­æœ‰ä¸€å¥assert len(liscense) % 8 &#x3D;&#x3D; 0ï¼Œæ­¤æ—¶å¦‚æœlen(liscense)ä¸º0ä¹Ÿæ˜¯æ»¡è¶³çš„ï¼Œå¹¶ä¸”not any(l)æ˜¯True<br>æ‰€ä»¥æˆ‘ä»¬ç›´æ¥æäº¤ä¸€ä¸ªç©ºlicenseå³å¯</p><p>ç„¶åç¨å¾®çˆ†ç ´ä¸€ä¸‹smoke_keyçš„é•¿åº¦ï¼Œå†é€ä¸ªçˆ†ç ´å³å¯æ‹¿åˆ°flag<br>exp(ç¨å¾®æœ‰ç‚¹ä¸‘é™‹):</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">import</span> string<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">send1</span>(<span class="hljs-params">s</span>):<br>    out=r.recvuntil(<span class="hljs-string">b&#x27;&gt; &#x27;</span>)<br>    r.sendline(<span class="hljs-string">b&#x27;1&#x27;</span>)<br>    out+=r.recvuntil(<span class="hljs-string">b&#x27;&gt; &#x27;</span>)<br><br>    r.sendline(s.encode())<br>    out+=r.recvuntil(<span class="hljs-string">b&#x27;\n&#x27;</span>)<br>    out+=r.recvuntil(<span class="hljs-string">b&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">return</span> out.decode()<br><br>context(os=<span class="hljs-string">&#x27;linux&#x27;</span>)<br><br>HOST=<span class="hljs-string">&#x27;139.155.126.78&#x27;</span><br>PORT=<span class="hljs-number">18806</span><br><br>r=remote(HOST,PORT)<br>out=r.recv(<span class="hljs-number">400</span>)<br><br><span class="hljs-comment">#æäº¤ç©ºlicense</span><br>r.sendline(<span class="hljs-string">b&#x27;2&#x27;</span>)<br>out=r.recv(<span class="hljs-number">400</span>)<br><br>r.sendline(<span class="hljs-string">b&#x27;123456&#x27;</span>)<br>out=r.recv(<span class="hljs-number">400</span>)<br><br>r.sendline(<span class="hljs-string">b&#x27;&#x27;</span>)<br>out=r.recv(<span class="hljs-number">800</span>)<br><span class="hljs-built_in">print</span>(out.decode())<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;=========&#x27;</span>)<br><br><span class="hljs-comment">#è¿™é‡Œä¹‹å‰æœ‰çˆ†è¿‡é•¿åº¦ï¼ŒèŠ‚çœæ—¶é—´ä»22å¼€å§‹çˆ†ï¼Œæ¯æ¬¡è¿æ¥çš„smoke_keyé•¿åº¦çš„ä¸å›ºå®šçš„</span><br>length=<span class="hljs-number">22</span><br>out=send1(<span class="hljs-string">&#x27;1&#x27;</span>*length)<br><span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;12&#x27;</span> <span class="hljs-keyword">in</span> out:<span class="hljs-comment">#å¦‚æœæ‰§è¡Œäº†if len(password) != len(smoke_key):åé¢çš„return False</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">30</span>):<br>        out=send1(<span class="hljs-string">&#x27;1&#x27;</span>*(length+i))<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;12&#x27;</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> out:<br>            length=length+i<br>            <span class="hljs-keyword">break</span><br><span class="hljs-built_in">print</span>(length)<br><br>key=<span class="hljs-string">&#x27;&#x27;</span><br>st=string.printable[:-<span class="hljs-number">5</span>]<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(length):<br>    <span class="hljs-built_in">print</span>(j)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> st:<br>        out=send1(<span class="hljs-string">r&#x27;&#x27;</span>+key+i+<span class="hljs-string">&#x27;0&#x27;</span>*(length-<span class="hljs-number">1</span>-j))<br>        left=out.find(<span class="hljs-string">&#x27;[&#x27;</span>)<br>        right=out.find(<span class="hljs-string">&#x27;]&#x27;</span>)<br>        <span class="hljs-keyword">if</span> left!=-<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> right!=-<span class="hljs-number">1</span>:<br>            l1=<span class="hljs-built_in">eval</span>(out[left:right+<span class="hljs-number">1</span>])<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(l1)&gt;<span class="hljs-number">2</span>:<br>                <span class="hljs-keyword">if</span> l1[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>]&gt;j+<span class="hljs-number">1</span>:<br>                    <span class="hljs-built_in">print</span>(l1)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;success&#x27;</span>)<br>                    key+=i<br>                    <span class="hljs-built_in">print</span>(key)<br>                    <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;over&#x27;</span>)<br>            <span class="hljs-built_in">print</span>(out)<br></code></pre></td></tr></table></figure><p>ç„¶åæˆåŠŸæ‹¿åˆ°flag</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">DASCTF</span>&#123;<span class="hljs-number">82027784803625989128426726039406</span>&#125;<br></code></pre></td></tr></table></figure><p>é¢˜ç›®æ²¡æœ‰å¯¹ç©ºlicenseè¿›è¡Œä¸€ä¸ªåˆ¤æ–­ï¼Œè¿™ä¹Ÿå°±æˆäº†ä¸€ä¸ªçªç ´ç‚¹</p><hr><p>å—¯ï¼Œå°±å…ˆè¿™ä¸¤é¢˜å§~ã€‚å‰©ä¸‹ä¸¤é¢˜ï¼Œä¸€é¢˜çœ‹æƒ…å†µï¼Œè¯´ä¸å®šä¼šå»çœ‹çœ‹wpå†æ›´æ–°ï¼Œå¦ä¸€é¢˜æˆ‘é¢˜ç›®éƒ½ä¸æƒ³çœ‹ã€‚å°±å…ˆåˆ°è¿™å§ã€‚<br><img src="/2025/01/22/2025.1.18DASCTF/2.jpg"></p>]]></content>
    
    
    <categories>
      
      <category>DASCTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DASCTF</tag>
      
      <tag>matrix</tag>
      
      <tag>RSA</tag>
      
      <tag>çŸ©é˜µ</tag>
      
      <tag>è®ºæ–‡å¤ç°</tag>
      
      <tag>é¶æœº</tag>
      
      <tag>ä¾§ä¿¡é“æ”»å‡»</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¢ç”µè„‘å•¦</title>
    <link href="/2025/01/22/%E6%8D%A2%E7%94%B5%E8%84%91%E5%95%A6/"/>
    <url>/2025/01/22/%E6%8D%A2%E7%94%B5%E8%84%91%E5%95%A6/</url>
    
    <content type="html"><![CDATA[<p>æ¢äº†å°ç”µè„‘ï¼Œgitæäº¤æ²¡é—®é¢˜äº†ï¼Œè¦å¼€å§‹æ›´æ–°åšå®¢å•¦<br><img src="/2025/01/22/%E6%8D%A2%E7%94%B5%E8%84%91%E5%95%A6/1.jpg" alt="å½“å½“å½“å½“"></p><p>ä¹‹åå¤§æ¦‚å°±æ˜¯ä¼šæ¯”èµ›çš„é¢˜ç›®å‡ºä¸€ç¯‡åšå®¢ï¼Œå¯†ç å‡ºä¸€ç¯‡åšå®¢ï¼Œæ‰€ä»¥å¯èƒ½ä¼šæœ‰ç‚¹é‡å¤ã€‚å—¯ã€‚</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>æ± å¡˜é‡Œçš„å°çŸ³å­</title>
    <link href="/2025/01/20/pictures/"/>
    <url>/2025/01/20/pictures/</url>
    
    <content type="html"><![CDATA[<h1 id="æ± å¡˜é‡Œçš„å°çŸ³å­"><a href="#æ± å¡˜é‡Œçš„å°çŸ³å­" class="headerlink" title="æ± å¡˜é‡Œçš„å°çŸ³å­"></a>æ± å¡˜é‡Œçš„å°çŸ³å­</h1><p>ä¼šæœ‰ä¸€äº›å°æ•…äº‹</p><h3 id="æ˜æ—¥æ–¹èˆŸ"><a href="#æ˜æ—¥æ–¹èˆŸ" class="headerlink" title="æ˜æ—¥æ–¹èˆŸ"></a>æ˜æ—¥æ–¹èˆŸ</h3><p><img src="/pictures/19.png" alt="1"><br><img src="/pictures/20.png" alt="2"><br><img src="/pictures/21.png" alt="3"><br><img src="/pictures/22.png" alt="4"><br><img src="/pictures/23.png" alt="5"><br><img src="/pictures/24.png" alt="6"><br><img src="/pictures/25.png" alt="7"></p>]]></content>
    
    
    
    <tags>
      
      <tag>æ˜æ—¥æ–¹èˆŸ</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
